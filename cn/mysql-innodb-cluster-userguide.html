<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" class="translated-ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>第21章InnoDB集群</title>
		<link rel="stylesheet" href="mvl.css" type="text/css">
		<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
		<link rel="start" href="index.html" title="{书名}">
		<link rel="up" href="" title="">
		<link rel="prev" href="document-store.html" title="第20章将MySQL用作文档存储">
		<link rel="next" href="mysql-cluster.html" title="第22章MySQL NDB Cluster 8.0">
	 
		<link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css">
	</head>

	<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
		<div class="navheader">
			<table width="100%" summary="Navigation header">
				<tbody>
					<tr>
						<th colspan="3" align="center">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21章InnoDB集群</font>
							</font>
						</th>
					</tr>
					<tr>
						<td width="20%" align="left"><a accesskey="p" href="document-store.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">上一页</font>
								</font>
							</a>&nbsp;</td>
						<th width="60%" align="center"></th>
						<td width="20%" align="right">&nbsp;<a accesskey="n" href="mysql-cluster.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">下一个</font>
								</font>
							</a></td>
					</tr>
				</tbody>
			</table>
			<hr>
		</div>
		<div class="chapter">
			<div class="titlepage">
				<div>
					<div>
						<h1 class="title"><a name="mysql-innodb-cluster-userguide"></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21章InnoDB集群</font>
							</font>
						</h1>

					</div>

				</div>

			</div>
			<div class="toc">
				<p><b>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">目录</font>
						</font>
					</b></p>
				<dl class="toc"><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-introduction">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.1 InnoDB集群简介</font>
								</font>
							</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-creating">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.2创建InnoDB集群</font>
								</font>
							</a></span></dt>
					<dd>
						<dl><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-deployment-methods">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.1部署方案</font>
										</font>
									</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-requirements">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.2 InnoDB集群要求</font>
										</font>
									</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-methods-installing">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.3安装方法</font>
										</font>
									</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.4 InnoDB集群的生产部署</font>
										</font>
									</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.5 InnoDB集群的沙箱部署</font>
										</font>
									</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-from-group-replication">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">21.2.6采用组复制部署</font>
										</font>
									</a></span></dt></dl>
					</dd><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-using-router">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.3将MySQL路由器与InnoDB集群配合使用</font>
								</font>
							</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-working-with-cluster">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.4使用InnoDB集群</font>
								</font>
							</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-limitations">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.5已知限制</font>
								</font>
							</a></span></dt>
				</dl>
			</div>
			<p>
				<font style="vertical-align: inherit;">
					<font style="vertical-align: inherit;">
						本章介绍MySQL InnoDB集群，它结合了MySQL技术，使您能够创建高度可用的MySQL服务器实例集群。
					</font>
				</font>
			</p>
			<div class="section">

				<div class="titlepage">
					<div>
						<div>
							<h2 class="title" style="clear: both"><a name="mysql-innodb-cluster-introduction"></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.1 InnoDB集群简介</font>
								</font>
							</h2>
						</div>
					</div>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							MySQL InnoDB集群为MySQL提供了完整的高可用性解决方案。
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/" target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">MySQL Shell</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">包含AdminAPI，使您可以轻松配置和管理一组至少三个MySQL服务器实例，以充当InnoDB集群。</font>
						<font style="vertical-align: inherit;">每个MySQL服务器实例都运行MySQL Group Replication，它提供了在InnoDB集群内复制数据的机制，具有内置故障转移功能。</font>
						<font style="vertical-align: inherit;">AdminAPI无需在InnoDB集群中直接使用组复制，但有关详细信息，请参阅
						</font>
					</font><a class="xref" href="group-replication.html" title="第18章组复制">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">第18章“ </font>
						</font><i>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">组复制”</font>
							</font>
						</i>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">，其中说明了详细信息。
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/" target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">MySQL路由器</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">可以根据您部署的集群自动配置自身，将客户端应用程序透明地连接到服务器实例。</font>
						<font style="vertical-align: inherit;">如果服务器实例意外故障，群集将自动重新配置。</font>
						<font style="vertical-align: inherit;">在默认的单主模式下，InnoDB集群具有单个读写服务器实例 - 主要实例。</font>
						<font style="vertical-align: inherit;">多个辅助服务器实例是主要副本的副本。</font>
						<font style="vertical-align: inherit;">如果主服务器出现故障，则辅助服务器将自动升级为主服务器。</font>
						<font style="vertical-align: inherit;">MySQL路由器检测到此情况并将客户端应用程序转发到新主服务器。</font>
						<font style="vertical-align: inherit;">高级用户还可以将群集配置为具有多原色。
						</font>
					</font>
				</p>
				<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

					<div class="admon-title">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								重要
							</font>
						</font>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								InnoDB集群不支持MySQL NDB Cluster。</font>
							<font style="vertical-align: inherit;">NDB Cluster依赖于</font>
						</font><a class="link" href="mysql-cluster.html" title="第22章MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">存储引擎以及许多特定于NDB Cluster的程序，这些程序未随MySQL Server 8.0提供;
							</font>
						</font><code class="literal">NDB</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">仅作为MySQL NDB Cluster分发的一部分提供。</font>
							<font style="vertical-align: inherit;">此外，</font>
							<font style="vertical-align: inherit;">MySQL Server 8.0提供</font>
							<font style="vertical-align: inherit;">的MySQL服务器二进制文件（</font>
						</font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">mysqld</font>
									</font>
								</strong></span></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">）不能与NDB Cluster一起使用。</font>
							<font style="vertical-align: inherit;">有关MySQL NDB Cluster的更多信息，请参见
							</font>
						</font><a class="xref" href="mysql-cluster.html" title="第22章MySQL NDB Cluster 8.0">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第22章，</font>
							</font><i>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">MySQL NDB Cluster 8.0</font>
								</font>
							</i>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font><a class="xref" href="mysql-cluster.html#mysql-cluster-compared" title="22.1.6使用InnoDB的MySQL服务器与NDB集群的比较">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">22.1.6节，“MySQL服务器使用的是InnoDB与NDB集群相比”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，提供了有关之间的差异</font>
						</font><code class="literal">InnoDB</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">NDB</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;"> 存储引擎。
							</font>
						</font>
					</p>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							下图显示了这些技术如何协同工作的概述：
						</font>
					</font>
				</p>
				<div class="figure">
					<a name="innodb-cluster-overview-image"></a>
					<p class="title"><b>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">图21.1 InnoDB集群概述</font>
							</font>
						</b></p>
					<div class="figure-contents">

						<div class="mediaobject">
							<img src="images/innodb_cluster_overview.png" width="600" height="753" alt="三台MySQL服务器组合在一起作为高可用性集群。 其中一个服务器是读/写主实例，另外两个是只读辅助实例。 组复制用于将数据从主实例复制到辅助实例。 MySQL路由器将客户端应用程序（在此示例中为MySQL连接器）连接到主实例。">
						</div>

					</div>

				</div>
				<br class="figure-break">
				<div class="simplesect">

					<div class="titlepage">
						<div>

							<div class="simple">
								<h3 class="title"><a name="admin-api"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">使用AdminAPI</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								MySQL Shell包含AdminAPI，可通过</font>
						</font><code class="literal">dba</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">全局变量及其相关方法访问。</font>
							<font style="vertical-align: inherit;">该</font>
						</font><code class="literal">dba</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">变量的方法使您能够部署，配置和管理InnoDB的集群。</font>
							<font style="vertical-align: inherit;">例如，使用该
							</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法创建InnoDB集群。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									MySQL Shell允许您通过套接字连接连接到服务器，但AdminAPI需要TCP连接到服务器实例。</font>
								<font style="vertical-align: inherit;">AdminAPI不支持基于套接字的连接。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								MySQL Shell为AdminAPI提供在线帮助。</font>
							<font style="vertical-align: inherit;">要列出所有可用</font>
						</font><code class="literal">dba</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令，请使用该
							</font>
						</font><code class="literal">dba.help()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法。</font>
							<font style="vertical-align: inherit;">有关特定方法的联机帮助，请使用常规格式
							</font>
						</font><code class="literal">object.help('methodname')</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.help('getCluster')</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从元数据存储中检索群集。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
句法</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  dba.getCluster（[name] [，options]）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
哪里</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  name：参数，用于指定要返回的集群的名称。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  选项：包含其他选项的词典。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
退货</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  由给定名称或默认群集标识的群集对象。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
描述</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果未指定name或为null，则将返回默认群集。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果指定了name，并且找不到具有指定名称的集群，则会出现错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将被提出。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
options字典接受connectToPrimary选项，默认为</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
true表示shell自动连接到主要成员</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
集群。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例外</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  以下场景中的MetadataError：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果元数据无法访问。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果元数据更新操作失败。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  以下场景中的ArgumentError：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果群集名称为空。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果群集名称无效。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果群集不存在。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  以下场景中的RuntimeError：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   - 如果当前连接不能用于组复制。</font></font><font></font>
</pre>
				</div>

			</div>
			<div class="section">
				<div class="titlepage">
					<div>
						<div>
							<h2 class="title" style="clear: both"><a name="mysql-innodb-cluster-creating"></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.2创建InnoDB集群</font>
								</font>
							</h2>

						</div>

					</div>

				</div>
				<div class="toc">
					<dl class="toc"><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-deployment-methods">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.1部署方案</font>
									</font>
								</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-requirements">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.2 InnoDB集群要求</font>
									</font>
								</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-methods-installing">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.3安装方法</font>
									</font>
								</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.4 InnoDB集群的生产部署</font>
									</font>
								</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.5 InnoDB集群的沙箱部署</font>
									</font>
								</a></span></dt><dt><span class="section"><a href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-from-group-replication">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.6采用组复制部署</font>
									</font>
								</a></span></dt></dl>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							本节介绍了创建InnoDB集群的不同方法，服务器实例的要求以及部署集群时需要安装的软件。
						</font>
					</font>
				</p>
				<div class="section">

					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-deployment-methods"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.1部署方案</font>
									</font>
								</h3>
							</div>
						</div>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								InnoDB集群支持以下部署方案：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<span class="emphasis"><em>
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">生产部署：</font>
											</font>
										</em></span>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">如果要在完整生产环境中使用InnoDB集群，则需要配置所需数量的计算机，然后将服务器实例部署到计算机。</font>
										<font style="vertical-align: inherit;">通过生产部署，您可以充分利用InnoDB集群的高可用性功能。</font>
										<font style="vertical-align: inherit;">有关说明</font>
									</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment"
									 title="21.2.4 InnoDB集群的生产部署">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">，</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">请参见
										</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment"
										 title="21.2.4 InnoDB集群的生产部署">
											<font style="vertical-align: inherit;">第21.2.4节“InnoDB集群的生产部署”</font>
										</a>
										<font style="vertical-align: inherit;">
											。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<span class="emphasis"><em>
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">沙箱部署：</font>
											</font>
										</em></span>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">如果要在提交完整生产部署之前测试InnoDB集群，则提供的沙箱功能使您可以在本地计算机上快速设置集群。</font>
										<font style="vertical-align: inherit;">使用所需配置创建沙盒服务器实例，您可以尝试InnoDB集群以熟悉所使用的技术。</font>
										<font style="vertical-align: inherit;">有关说明</font>
									</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment"
									 title="21.2.5 InnoDB集群的沙箱部署">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">，</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">请参见
										</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment"
										 title="21.2.5 InnoDB集群的沙箱部署">
											<font style="vertical-align: inherit;">第21.2.5节“InnoDB集群的沙箱部署”</font>
										</a>
										<font style="vertical-align: inherit;">
											。
										</font>
									</font>
								</p>
								<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

									<div class="admon-title">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												重要
											</font>
										</font>
									</div>
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												沙箱部署不适合在完整的生产环境中使用。
											</font>
										</font>
									</p>
								</div>
							</li>
						</ul>
					</div>

				</div>
				<div class="section">
					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-requirements"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.2 InnoDB集群要求</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在安装InnoDB集群的生产部署之前，请确保您要使用的服务器实例满足以下要求。
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											InnoDB集群使用组复制，因此您的服务器实例必须满足相同的要求。</font>
										<font style="vertical-align: inherit;">请参见
										</font>
									</font><a class="xref" href="group-replication.html#group-replication-requirements" title="18.9.1组复制要求">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">第18.9.1节“组复制要求”</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">AdminAPI提供了
										</font>
									</font><code class="literal">dba.checkInstanceConfiguration()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">验证实例是否满足组复制要求的</font>
									</font><code class="literal">dba.configureInstance()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">方法</font>
										<font style="vertical-align: inherit;">，以及
										</font>
										<font style="vertical-align: inherit;">配置实例以满足要求的方法。
										</font>
									</font>
								</p>
								<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

									<div class="admon-title">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												注意
											</font>
										</font>
									</div>
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												使用沙箱部署时，实例将配置为自动满足这些要求。
											</font>
										</font>
									</p>
								</div>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											组复制成员可以使用比其它存储引擎包含表</font>
									</font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">，例如</font>
									</font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">这些表不能由Group Replication写入，因此在使用InnoDB集群时也是如此。</font>
										<font style="vertical-align: inherit;">为了能够使用InnoDB集群写入此类表，请</font>
									</font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">在使用InnoDB集群中的实例之前</font>
										<font style="vertical-align: inherit;">将所有此类表转换为
										</font>
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											必须在要与InnoDB集群一起使用的任何实例上启用性能模式。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											MySQL Shell用于配置在InnoDB集群中使用的服务器的配置脚本需要访问Python 2.7版。</font>
										<font style="vertical-align: inherit;">对于沙箱部署，在用于部署的单个机器上需要Python，生产部署需要在每个应在本地运行MySQL
											Shell的服务器实例上使用Python，请参阅
										</font>
									</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings"
									 title="持久设置">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">持久设置</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											在Windows上，MySQL Shell包含Python，不需要用户配置。</font>
										<font style="vertical-align: inherit;">在Unix上，必须将Python作为shell环境的一部分。</font>
										<font style="vertical-align: inherit;">要检查您的系统是否正确配置了Python，请发出：
										</font>
									</font>
								</p>
								<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ </font></font><strong class="userinput"><code>/usr/bin/env python</code></strong></pre>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果Python解释器启动，则无需进一步操作。</font>
										<font style="vertical-align: inherit;">如果上一个命令失败，请在</font>
									</font><code class="literal">/usr/bin/python</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">您选择的Python二进制文件</font>
										<font style="vertical-align: inherit;">之间创建一个软链接</font>
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>

				</div>
				<div class="section">
					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-methods-installing"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.3安装方法</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								用于安装InnoDB集群的方法取决于您要使用的部署类型。</font>
							<font style="vertical-align: inherit;">对于沙箱部署，将InnoDB集群的组件安装到单个计算机上。</font>
							<font style="vertical-align: inherit;">沙箱部署是单个计算机的本地部署，因此安装只需在本地计算机上执行一次。</font>
							<font style="vertical-align: inherit;">对于生产部署，请将组件安装到要添加到群集的每台计算机上。</font>
							<font style="vertical-align: inherit;">生产部署使用运行MySQL服务器实例的多个远程主机，因此您需要使用SSH或Windows远程桌面等工具连接到每台计算机，以执行安装组件等任务。</font>
							<font style="vertical-align: inherit;">可以使用以下安装InnoDB集群的方法：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											使用以下文档下载和安装组件：
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														MySQL服务器 - 请参阅</font>
												</font><a class="xref" href="installing.html" title="第2章安装和升级MySQL">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">第2章，</font>
													</font><i>
														<font style="vertical-align: inherit;">
															<font style="vertical-align: inherit;">安装和升级MySQL</font>
														</font>
													</i>
												</a>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														MySQL Shell - 请参阅
													</font>
												</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-install.html" target="_top">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">安装MySQL Shell</font>
													</font>
												</a>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														MySQL路由器 - 请参阅
													</font>
												</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-installation.html"
												 target="_top">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">安装MySQL路由器</font>
													</font>
												</a>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">。
													</font>
												</font>
											</p>
										</li>
									</ul>
								</div>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											在Windows上，您可以使用MySQL Installer for Windows进行沙箱部署。</font>
										<font style="vertical-align: inherit;">有关详细信息，请参见
										</font>
									</font><a class="xref" href="installing.html#mysql-installer-workflow-innodb-cluster" title="2.3.3.3.1.1高可用性">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">第2.3.3.3.1.1节“高可用性”</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								安装InnoDB集群所需的软件后，请选择
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment" title="21.2.5 InnoDB集群的沙箱部署">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21.2.5节“InnoDB集群的沙箱部署”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">或
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment"
						 title="21.2.4 InnoDB集群的生产部署">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21.2.4节“InnoDB集群的生产部署”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<div class="section">
					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-production-deployment"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.4 InnoDB集群的生产部署</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在生产环境中工作时，构成InnoDB集群的MySQL服务器实例作为网络的一部分在多台主机上运行，​​而不是在单机上运行，​​如
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-sandbox-deployment" title="21.2.5 InnoDB集群的沙箱部署">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21.2.5节“InnoDB集群的沙箱部署”中所述</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">在继续执行这些说明之前，必须将所需的软件安装到要作为服务器实例添加到群集的每台计算机上，请参见
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-methods-installing" title="21.2.3安装方法">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21.2.3节“安装方法”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								下图说明了您在本节中使用的方案：
							</font>
						</font>
					</p>
					<div class="figure">
						<a name="production-servers-image"></a>
						<p class="title"><b>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">图21.2生产部署</font>
								</font>
							</b></p>
						<div class="figure-contents">

							<div class="mediaobject">
								<img src="images/production_servers.png" width="600" height="837" alt="三台MySQL服务器组合在一起作为生产InnoDB集群。 其中一个服务器是主实例，另外两个是辅助实例。 主服务器的IP地址为139.59.177.10，两个辅助实例的IP地址为139.59.177.11和139.59.177.12。 MySQL路由器将客户端应用程序连接到主实例。 MySQL Shell中的管理功能直接与生产InnoDB集群交互。">
							</div>

						</div>

					</div>
					<br class="figure-break">
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									与沙箱部署（其中所有实例都本地部署到AdminAPI具有本地文件访问权限并且可以保留配置更改的一台计算机）不同，对于生产部署，您必须在实例上保留所有配置更改。</font>
								<font style="vertical-align: inherit;">如何执行此操作取决于在实例上运行的MySQL版本，请参阅“
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">持久设置”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要将服务器的连接信息传递给AdminAPI，请使用URI类型字符串或数据字典，请参见
							</font>
						</font><a class="xref" href="programs.html#connecting-using-uri-or-key-value-pairs" title="4.2.4使用URI或键值对进行连接">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第4.2.4节“使用URI或键值对进行连接”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">在此文档中，显示了URI类型字符串。
							</font>
						</font>
					</p>
					<div class="simplesect">

						<div class="titlepage">
							<div>

								<div class="simple">
									<h4 class="title"><a name="mysql-innodb-cluster-user-privileges"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">用户权限</font>
										</font>
									</h4>
								</div>
							</div>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									用于管理实例的用户帐户不必是root帐户，但用户需要分配全读，除了全面的MySQL管理员特权写在InnoDB的集群的元数据表的权限（</font>
							</font><code class="literal">SUPER</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，</font>
							</font><code class="literal">GRANT
								OPTION</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，</font>
							</font><code class="literal">CREATE</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，
								</font>
							</font><code class="literal">DROP</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">等） 。</font>
								<font style="vertical-align: inherit;">创建用户以管理群集的首选方法是使用</font>
							</font><code class="literal">clusterAdmin</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">带有</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">和
								</font>
							</font><code class="literal">Cluster.addInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">操作</font>
								<font style="vertical-align: inherit;">的
								</font>
								<font style="vertical-align: inherit;">选项
								</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">在此过程中，用户</font>
							</font><code class="literal">ic</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">显示在示例中。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果仅需要读取操作（例如用于监视目的），则可以使用具有更多受限特权的帐户。</font>
								<font style="vertical-align: inherit;">为用户</font>
							</font><em class="replaceable"><code>your_user</code></em>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									提供监控InnoDB集群问题所需的权限：
								</font>
							</font>
						</p>
						<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GRANT SELECT on mysql_innodb_cluster_metadata。* TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.global_status TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_applier_configuration TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_applier_status TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_applier_status_by_coordinator TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_applier_status_by_worker TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_connection_configuration TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_connection_status TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_group_member_stats TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.replication_group_members TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT SELECT ON performance_schema.threads TO </font></font><em class="replaceable"><code>your_user@'%'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WITH GRANT OPTION; 
</font></font></pre>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="mysql-innodb-cluster-users-created"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">InnoDB Cluster创建的用户帐户</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									作为使用组复制的一部分，InnoDB集群创建内部用户，以便在集群中的服务器之间进行复制。</font>
								<font style="vertical-align: inherit;">这些用户是群集的内部用户，生成的用户的用户名遵循命名方案
								</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">用于内部用户的主机名取决于是否</font>
								<font style="vertical-align: inherit;">已配置</font>
								<font style="vertical-align: inherit;">该</font>
								<font style="vertical-align: inherit;">选项。</font>
								<font style="vertical-align: inherit;">如果</font>
								<font style="vertical-align: inherit;">未配置，则默认为，</font>
								<font style="vertical-align: inherit;">并且使用通配符</font>
								<font style="vertical-align: inherit;">
									和</font>
								<font style="vertical-align: inherit;">主机名值</font>
								<font style="vertical-align: inherit;">创建内部用户</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">当</font>
								<font style="vertical-align: inherit;">已配置，在每个地址
								</font>
							</font><code class="literal">mysql_innodb_cluster_r[<em class="replaceable"><code>10_numbers</code></em>]</code>
							<font style="vertical-align: inherit;"></font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;"></font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;"></font><code class="literal">AUTOMATIC</code>
							<font style="vertical-align: inherit;"></font><code class="literal">%</code>
							<font style="vertical-align: inherit;"></font><code class="literal">localhost</code>
							<font style="vertical-align: inherit;"></font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;"></font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">列表创建了一个内部用户。</font>
								<font style="vertical-align: inherit;">有关更多信息，请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#create-whitelist-servers" title="创建服务器白名单">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">创建服务器白名单</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									每个内部用户都有一个随机生成的密码。</font>
								<font style="vertical-align: inherit;">随机生成的用户将获得以下授权：
								</font>
							</font>
						</p>
						<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">授予复制权限*。*至</font></font><em class="replaceable"><code>internal_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									内部用户帐户在种子实例上创建，然后复制到群集中的其他实例。</font>
								<font style="vertical-align: inherit;">内部用户是：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												通过发出创建新集群时生成的
											</font>
										</font><code class="literal">dba.createCluster()</code>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												通过发出将新实例添加到群集时生成
											</font>
										</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.addInstance()</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">。
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									此外，</font>
							</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rejoinInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									当使用该</font>
							</font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项指定主机名</font>
								<font style="vertical-align: inherit;">时</font>
								<font style="vertical-align: inherit;">，该
								</font>
								<font style="vertical-align: inherit;">操作还可能导致生成新的内部用户</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">例如，通过发布：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster.rejoinInstance（{ipWhitelist：“192.168.1.1 / 22”}）;</font></font></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									删除所有以前存在的内部用户并创建新的内部用户，同时考虑所</font>
							</font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">使用</font>
								<font style="vertical-align: inherit;">的
								</font>
								<font style="vertical-align: inherit;">值。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									有关Group Replication所需的内部用户的更多信息，请参见
								</font>
							</font><a class="xref" href="group-replication.html#group-replication-user-credentials" title="18.2.1.3用户凭证">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第18.2.1.3节“用户凭据”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="mysql-innodb-cluster-production-hostname"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">配置主机名</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									组成集群的生产实例在不同的计算机上运行，​​因此每台计算机必须具有唯一的主机名，并且能够解析在集群中运行服务器实例的其他计算机的主机名。</font>
								<font style="vertical-align: inherit;">如果不是这种情况，您可以：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												配置每台计算机以将每台其他计算机的IP映射到主机名。</font>
											<font style="vertical-align: inherit;">有关详细信息，请参阅操作系统文档 </font>
											<font style="vertical-align: inherit;">这是推荐的解决方案。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												设置DNS服务
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												将</font>
										</font><a class="link" href="replication.html#sysvar_report_host"><code class="literal">report_host</code></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												每个实例的MySQL配置中</font>
											<font style="vertical-align: inherit;">的</font>
											<font style="vertical-align: inherit;">变量配置为合适的外部可访问地址
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									在此过程中，主机名
								</font>
								<font style="vertical-align: inherit;">用于示例中。
								</font>
							</font><code class="literal">ic-<em class="replaceable"><code>number</code></em></code>
							<font style="vertical-align: inherit;"></font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要验证是否正确配置了MySQL服务器的主机名，请执行以下查询以查看实例如何将其自己的地址报告给其他服务器，并尝试使用返回的地址从其他主机连接到该MySQL服务器：
								</font>
							</font>
						</p>
						<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT coalesce（@@ report_host，@@ hostname）;</font></font></pre>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="mysql-innodb-cluster-persisting-settings"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">持久设置</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									您用于处理群集的AdminAPI命令，它的服务器实例会修改实例的配置。</font>
								<font style="vertical-align: inherit;">根据MySQL Shell连接到实例的方式以及实例上安装的MySQL版本，这些配置更改可以自动保留到实例。</font>
								<font style="vertical-align: inherit;">对实例保持设置可确保在实例重新启动后保留配置更改，有关背景信息，请参阅
								</font>
							</font><a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET
									PERSIST</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">这对于可靠的群集使用至关重要，例如，如果设置未持久化，则添加到群集的实例在重新启动后不会重新加入群集，因为配置更改会丢失。</font>
								<font style="vertical-align: inherit;">以下操作后需要进行持续更改：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<code class="literal">dba.configureInstance()</code>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">dba.createCluster()</code>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal"><em class="replaceable"><code>Cluster</code></em>.addInstance()</code>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance()</code>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal"><em class="replaceable"><code>Cluster</code></em>.rejoinInstance()</code>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									满足以下要求的实例会自动支持持久配置更改：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												该实例正在运行MySQL 8.0.11或更高版本
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<a class="link" href="server-administration.html#sysvar_persisted_globals_load"><code class="literal">persisted_globals_load</code></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> 被设置为 </font>
										</font><code class="literal">ON</code>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									不满足这些要求的实例不支持自动进行持久性配置更改，当AdminAPI操作导致实例设置的更改持续存在时，您会收到警告，例如：
								</font>
							</font>
						</p>
						<pre data-lang="simple" class="programlisting">	<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告：自MySQL版本5.7.21以来，实例“localhost：3320”成员身份更改无法保留 </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不支持SET PERSIST命令（需要MySQL版本&gt; = 8.0.5）。</font><font style="vertical-align: inherit;">请使用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本地&lt;Dba&gt; .configureLocalInstance命令可以保留更改。</font></font><font></font>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									当针对当前正在运行MySQL Shell的MySQL实例发出AdminAPI命令时，换句话说，本地实例MySQL Shell将配置更改直接保存到实例。</font>
								<font style="vertical-align: inherit;">在支持持久配置更改的本地实例上，配置更改将持久保存到实例的
								</font>
							</font><code class="filename">mysqld-auto.cnf</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">文件，配置更改不需要任何进一步的步骤。</font>
								<font style="vertical-align: inherit;">在不支持自动持久配置更改的本地实例上，您需要在本地进行更改，请参阅</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									当针对远程实例运行时，换句话说，运行MySQL Shell当前运行的实例以外的实例，如果实例支持自动保持配置更改，则AdminAPI命令会保持对实例的配置更改
								</font>
							</font><code class="filename">mysql-auto.conf</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项文件。</font>
								<font style="vertical-align: inherit;">如果远程实例不支持自动持久配置更改，则AdminAPI命令无法自动配置实例的选项文件。</font>
								<font style="vertical-align: inherit;">这意味着AdminAPI命令可以从实例读取信息，例如显示当前配置，但是对配置的更改不能持久保存到实例的选项文件。</font>
								<font style="vertical-align: inherit;">在这种情况下，您需要在本地持久保存更改，请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="mysql-innodb-cluster-logging"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">详细记录</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									使用生产部署时，为MySQL Shell配置详细日志记录会很有用，日志中的信息可以帮助您查找和解决在准备服务器实例作为InnoDB集群的一部分时可能发生的任何问题。</font>
								<font style="vertical-align: inherit;">要使用详细日志记录级别启动MySQL Shell，请使用以下
								</font>
							</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysqlsh.html#option_mysqlsh_log-level"
							 target="_top"><code class="option">--log-level</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项：
								</font>
							</font>
						</p>
						<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlsh --log-level=DEBUG3</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									该</font>
							</font><code class="literal">DEBUG3</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">建议，请
								</font>
							</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysqlsh.html#option_mysqlsh_log-level"
							 target="_top"><code class="option">--log-level</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">以获取更多信息。</font>
								<font style="vertical-align: inherit;">当</font>
							</font><code class="literal">DEBUG3</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">设置了MySQL壳牌日志文件包含例如线</font>
							</font><code class="literal">Debug:
								execute_sql( ... )</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，其包含被作为各AdminAPI呼叫的一部分执行的SQL查询。</font>
								<font style="vertical-align: inherit;">MySQL Shell生成的日志文件位于
								</font>
							</font><code class="filename">~/.mysqlsh/mysqlsh.log</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">基于Unix的系统中; </font>
								<font style="vertical-align: inherit;">在Microsoft Windows系统上，它位于
								</font>
							</font><code class="filename">%APPDATA%\MySQL\mysqlsh\mysqlsh.log</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">有关</font>
								<font style="vertical-align: inherit;">更多信息，
								</font>
								<font style="vertical-align: inherit;">请参阅
								</font>
							</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-application-log.html"
							 target="_top">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">MySQL Shell应用程序日志</font>
								</font>
							</a>
							<font style="vertical-align: inherit;"></font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									除了启用MySQL Shell日志级别之外，您还可以在发出每个命令后配置Admin Shell在MySQL Shell中提供的输出量。</font>
								<font style="vertical-align: inherit;">要在MySQL Shell问题中启用AdminAPI输出量：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; dba.verbose = 2</font></font></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									这将启用AdminAPI调用的最大输出。</font>
								<font style="vertical-align: inherit;">可用的输出水平是：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												0或OFF是默认值。</font>
											<font style="vertical-align: inherit;">这提供了最小的输出，是不进行故障排除时的推荐级别。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												1或ON会将每次调用的详细输出添加到AdminAPI。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												2将调试输出添加到详细输出，提供有关每次调用AdminAPI的内容的完整信息。
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>

					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="configuring-production-instances"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">配置生产实例</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									AdminAPI提供的
								</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">功能可检查实例是否针对InnoDB群集使用情况进行了适当配置，并在发现任何与InnoDB群集不兼容的设置时配置实例。</font>
								<font style="vertical-align: inherit;">您</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">针对实例</font>
								<font style="vertical-align: inherit;">运行该
								</font>
								<font style="vertical-align: inherit;">命令，并检查启用该实例以用于InnoDB群集使用所需的所有设置。</font>
								<font style="vertical-align: inherit;">如果实例不需要更改配置，则无需修改实例的配置，并且
								</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">命令输出确认实例已准备好使用InnoDB群集。</font>
								<font style="vertical-align: inherit;">如果要使实例与InnoDB集群兼容，则需要进行任何更改，将显示不兼容设置的报告，您可以选择让命令对实例的选项文件进行更改。</font>
								<font style="vertical-align: inherit;">根据MySQL
									Shell连接到实例的方式以及在实例上运行的MySQL版本，您可以通过将这些更改持久保存到远程实例的选项文件来永久更改这些更改，请参阅“
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">持久设置”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">不支持持久配置更改的实例会自动要求您在本地配置实例，请参阅</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">使用配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">或者，您可以手动更改实例的选项文件，</font>
								<font style="vertical-align: inherit;">有关详细信息</font>
								<font style="vertical-align: inherit;">，请参见</font>
							</font><a class="xref" href="programs.html#option-files" title="4.2.2.2使用选项文件">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第4.2.2.2节“使用选项文件”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">无论您进行配置更改的方式如何，您可能必须重新启动MySQL以确保检测到配置更改。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									该</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									命令</font>
								<font style="vertical-align: inherit;">的语法</font>
								<font style="vertical-align: inherit;">是：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dba.configureInstance（[ </font></font><em class="replaceable"><code>instance</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] [，</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]）
</font></font></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									其中</font>
							</font><em class="replaceable"><code>instance</code></em>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">是实例定义，</font>
							</font><em class="replaceable"><code>options</code></em>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">是一个数据字典，其中包含用于配置操作的其他选项。</font>
								<font style="vertical-align: inherit;">该命令返回有关操作结果的描述性文本消息。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									实例定义是实例的连接数据。</font>
								<font style="vertical-align: inherit;">如果目标实例已属于InnoDB集群，则会生成错误，并且该过程将失败。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									选项字典可以包含以下内容：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<code class="literal">mycnfPath</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 实例的MySQL选项文件的路径。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">outputMycnfPath</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 用于写入实例的MySQL选项文件的备用输出路径。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">password</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 连接使用的密码。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">clusterAdmin</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 要创建的InnoDB集群管理员用户的名称。</font>
											<font style="vertical-align: inherit;">支持的格式是标准的MySQL帐户名称格式。</font>
											<font style="vertical-align: inherit;">支持用户名和主机名的标识符或字符串。</font>
											<font style="vertical-align: inherit;">默认情况下，如果不加引号，则假定input是一个字符串。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">clusterAdminPassword</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">- 使用创建的InnoDB集群管理员帐户的密码</font>
										</font><code class="literal">clusterAdmin</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">clearReadOnly</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">- 用于确认</font>
										</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">应设置为off </font>
											<font style="vertical-align: inherit;">的布尔值
											</font>
											<font style="vertical-align: inherit;">，请参阅
											</font>
										</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">超级只读和实例</font>
											</font>
										</a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">interactive</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 用于在命令执行中禁用交互式向导的布尔值，因此不会向用户提供提示，也不会显示确认提示。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">restart</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 一个布尔值，用于指示应执行目标实例的远程重新启动以完成操作。
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									连接密码可以包含在实例定义中。</font>
								<font style="vertical-align: inherit;">或者，可以使用</font>
							</font><code class="literal">password</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项</font>
								<font style="vertical-align: inherit;">指定它来覆盖它</font>
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									一旦</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">针对实例发出，该命令将检查实例的设置是否适合InnoDB群集使用。</font>
								<font style="vertical-align: inherit;">将显示一个报告，显示InnoDB群集所需的设置。</font>
								<font style="vertical-align: inherit;">如果实例不需要对其设置进行任何更改，则可以在InnoDB集群中使用它，并可以继续
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#create-cluster" title="创建群集">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">创建集群</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">如果实例的设置对InnoDB群集使用无效，则该
								</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">命令将显示需要修改的设置。</font>
								<font style="vertical-align: inherit;">在配置实例之前，系统会提示您使用以下信息确认表中显示的更改：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<code class="literal">Variable</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 无效的配置变量。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">Current Value</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 无效配置变量的当前值。
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<code class="literal">Required Value</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> - 配置变量所需的值。
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如何继续取决于实例是否支持持久设置，请参阅“
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">持久设置”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">当</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">针对MySQL Shell当前运行的MySQL实例（即本地实例）发出时，它会尝试自动配置实例。</font>
								<font style="vertical-align: inherit;">何时
								</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">针对远程实例发出，如果实例支持自动保持配置更改，则可以选择执行此操作。</font>
								<font style="vertical-align: inherit;">如果远程实例不支持持久化更改以配置InnoDB群集使用，则必须在本地配置实例。</font>
								<font style="vertical-align: inherit;">请参阅使用
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									通常，</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">配置选项文件</font>
								<font style="vertical-align: inherit;">后不需要重新启动实例
								</font>
								<font style="vertical-align: inherit;">，但对于某些特定设置，可能需要重新启动。</font>
								<font style="vertical-align: inherit;">此信息显示在发布后生成的报告中</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">如果实例支持该
								</font>
							</font><a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART语法"><code class="literal">RESTART</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">语句，MySQL Shell可以关闭然后启动实例。</font>
								<font style="vertical-align: inherit;">这可确保mysqld检测到对实例选项文件所做的更改。</font>
								<font style="vertical-align: inherit;">欲了解更多信息，请参阅
								</font>
							</font><a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART语法"><code class="literal">RESTART</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										注意
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										执行</font>
								</font><a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART语法"><code class="literal">RESTART</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										语句后，实例的当前连接将丢失。</font>
									<font style="vertical-align: inherit;">如果启用了自动重新连接，则在服务器重新启动后将重新建立连接。</font>
									<font style="vertical-align: inherit;">否则，必须手动重新建立连接。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									该</font>
							</font><code class="literal">dba.configureInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">方法验证合适的用户是否可用于群集使用，该群集用于群集成员之间的连接，请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-user-privileges" title="用户权限">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">用户权限</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">添加合适用户的推荐方法是使用
								</font>
							</font><code class="literal">clusterAdmin</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">和
								</font>
							</font><code class="literal">clusterAdminPassword</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项，这使您可以在调用函数时配置群集用户和密码。</font>
								<font style="vertical-align: inherit;">例如：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; dba.configureInstance（'ic @ ic-1：3306'，\ </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{clusterAdmin：“'icadmin'@'ic-1％'”，clusterAdminPassword：' </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'}）;</font></font></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									此用户被授予能够管理群集的权限。</font>
								<font style="vertical-align: inherit;">接受的用户名格式遵循标准的MySQL帐户名称格式，请参见
								</font>
							</font><a class="xref" href="security.html#account-names" title="6.2.4指定帐户名称">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第6.2.4节“指定帐户名称”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果未指定用户来管理群集，则在交互模式下，可以使用向导选择以下选项之一：
								</font>
							</font>
						</p>
						<div class="itemizedlist">
							<ul class="itemizedlist" style="list-style-type: disc; ">
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												为root用户启用远程连接


											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												创建一个新用户，相当于指定
											</font>
										</font><code class="literal">clusterAdmin</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">和
											</font>
										</font><code class="literal">clusterAdminPassword</code>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">选项
											</font>
										</font>
									</p>
								</li>
								<li class="listitem">
									<p>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">
												没有自动配置，在这种情况下您需要手动创建用户
											</font>
										</font>
									</p>
								</li>
							</ul>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									以下示例演示了为群集使用创建新用户的选项。
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">	
MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.configureLocalInstance('root@localhost:3306')</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请提供'root @ localhost：3306'的密码：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请指定MySQL配置文件的路径：/etc/mysql/mysql.conf.d/mysqld.cnf</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
验证实例......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配置已更新，但需要重新启动服务器。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “config_errors”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“关闭”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “选项”：“enforce_gtid_consistency”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“开”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“关闭”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “选项”：“gtid_mode”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“开”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“0”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “option”：“log_bin”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“1”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“0”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “option”：“log_slave_updates”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“开”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“文件”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “option”：“master_info_repository”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“表”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“文件”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “option”：“relay_log_info_repository”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必需”：“表”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “当前”：“关闭”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “option”：“transaction_write_set_extraction”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “必填”：“XXHASH64”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “错误”：[]，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “restart_required”：是的，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “状态”：“错误”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的-JS&gt;</font></font><font></font>
</pre>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果实例有，
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。</font>
									<font style="vertical-align: inherit;">有关</font>
									<font style="vertical-align: inherit;">详细信息，</font>
									<font style="vertical-align: inherit;">请参阅
									</font>
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>

					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="create-cluster"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">创建群集</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									准备好实例后，使用该
								</font>
							</font><code class="literal">dba.createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">功能创建群集。</font>
								<font style="vertical-align: inherit;">您运行MySQL Shell的计算机将用作群集的种子实例。</font>
								<font style="vertical-align: inherit;">种子实例将复制到您添加到群集的其他实例，从而使它们成为种子实例的副本。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									在创建集群之前，MySQL Shell必须连接到实例，因为当您发出
								</font>
								<font style="vertical-align: inherit;">
									MySQL Shell时，会创建与连接到MySQL Shell当前全局会话的服务器实例的MySQL协议会话。</font>
								<font style="vertical-align: inherit;">使用该
								</font>
								<font style="vertical-align: inherit;">
									函数创建集群并将返回的集群分配给名为的变量</font>
								<font style="vertical-align: inherit;">：
								</font>
							</font><code class="literal">dba.createCluster(<em class="replaceable"><code>name</code></em>)</code>
							<font style="vertical-align: inherit;"></font><code class="literal">dba.createCluster(<em class="replaceable"><code>name</code></em>)</code>
							<font style="vertical-align: inherit;"></font><code class="literal">cluster</code>
							<font style="vertical-align: inherit;"></font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      
MySQL的-JS&gt; </font></font><strong class="userinput"><code>var cluster = dba.createCluster('testCluster')</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在ic @ ic-1验证实例：3306 ...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此实例将其自己的地址报告为ic-1</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例配置是合适的。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在'ic @ ic-1：3306'上创建InnoDB集群'testCluster'......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添加种子实例...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
群集已成功创建。</font><font style="vertical-align: inherit;">使用Cluster.addInstance（）添加MySQL实例。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
至少需要3个实例才能使集群能够承受最多</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一台服务器故障。</font></font><font></font>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									返回的Cluster对象使用一个独立于MySQL Shell主会话的新会话。</font>
								<font style="vertical-align: inherit;">这可确保如果更改MySQL Shell全局会话，Cluster对象将维护其与实例的会话。
								</font>
							</font>
						</p>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果实例有，
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。</font>
									<font style="vertical-align: inherit;">有关</font>
									<font style="vertical-align: inherit;">详细信息，</font>
									<font style="vertical-align: inherit;">请参阅
									</font>
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>
						<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										注意
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果遇到与无法访问的元数据相关的错误，则可能配置了环回网络接口。</font>
									<font style="vertical-align: inherit;">要正确使用InnoDB群集，请禁用环回接口。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要检查是否已创建群集，请使用群集实例的</font>
							</font><code class="literal">status()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">功能。</font>
								<font style="vertical-align: inherit;">请参阅使用
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#check-innodb-cluster-status" title="使用Cluster.status（）检查集群的状态">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">检查群集的状态
									</font>
								</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										一旦服务器实例属于一个集群，重要的是只使用MySQL Shell和AdminAPI来管理它们。</font>
									<font style="vertical-align: inherit;">尝试在实例添加到群集后手动更改组复制的配置不受支持。</font>
									<font style="vertical-align: inherit;">同样，不支持修改对InnoDB集群至关重要的服务器变量，例如</font>
								</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">在使用AdminAPI配置实例之后。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">


									使用MySQL Shell 8.0.14及更高版本创建集群时，可以在实例从集群中排除之前设置超时，例如，当它们无法访问时。</font>
								<font style="vertical-align: inherit;">将</font>
							</font><code class="literal">expelTimeout</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项</font>
								<font style="vertical-align: inherit;">传递</font>
								<font style="vertical-align: inherit;">给
								</font>
							</font><code class="literal">dba.createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">操作，该操作</font>
							</font><a class="link" href="group-replication.html#sysvar_group_replication_member_expel_timeout"><code class="literal">group_replication_member_expel_timeout</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									在种子实例上</font>
								<font style="vertical-align: inherit;">配置
								</font>
								<font style="vertical-align: inherit;">变量。</font>
								<font style="vertical-align: inherit;">该
								</font>
							</font><code class="literal">expelTimeout</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项可以采用0到3600范围内的整数值。运行MySQL服务器8.0.13及更高版本的所有实例（已添加到已</font>
							</font><code class="literal">expelTimeout</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">配置</font>
								<font style="vertical-align: inherit;">的集群）
								</font>
								<font style="vertical-align: inherit;">将自动配置为具有与</font>
							</font><code class="literal">expelTimeout</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									种子实例上配置的值</font>
								<font style="vertical-align: inherit;">相同的</font>
								<font style="vertical-align: inherit;">值。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									有关可以传递给的其他选项的信息
								</font>
							</font><code class="literal">dba.createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，请参见
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-working-with-cluster"
							 title="21.4使用InnoDB集群">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第21.4节“使用InnoDB Cluster”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="add-instances-cluster"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">将实例添加到群集</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									使用此
								</font>
								<font style="vertical-align: inherit;">
									功能可向群集添加更多实例，其中
								</font>
								<font style="vertical-align: inherit;">是已配置实例的连接信息，请参阅
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-production-instances" title="配置生产实例">
									<font style="vertical-align: inherit;">配置生产实例</font>
								</a>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">群集中至少需要三个实例，以使其能够容忍一个实例的失败。</font>
								<font style="vertical-align: inherit;">添加更多实例会增加对实例失败的容忍度。</font>
								<font style="vertical-align: inherit;">要向集群问题添加实例：
								</font>
							</font><code class="literal">cluster.addInstance(<em class="replaceable"><code>instance</code></em>)</code>
							<font style="vertical-align: inherit;"></font><em class="replaceable"><code>instance</code></em>
							<font style="vertical-align: inherit;"></font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-production-instances"
							 title="配置生产实例">
								<font style="vertical-align: inherit;"></font>
							</a>
							<font style="vertical-align: inherit;"></font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.addInstance('ic@ic-2:3306')</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将在InnoDB集群中添加一个新实例。</font><font style="vertical-align: inherit;">取决于数量</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
群集上的数据可能需要几秒钟到几个小时。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请提供“ic @ ic-2：3306”的密码：********</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将实例添加到集群中......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在ic-2验证实例：3306 ...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此实例将其自己的地址报告为ic-2</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例配置是合适的。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例“ic @ ic-2：3306”已成功添加到群集中。</font></font><font></font>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要验证是否已添加实例，请使用集群实例的</font>
							</font><code class="literal">status()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">功能。</font>
								<font style="vertical-align: inherit;">例如，这是添加第二个实例后沙箱集群的状态输出：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.status()</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “clusterName”：“testCluster”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “defaultReplicaSet”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “名称”：“默认”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “primary”：“localhost：3310”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “ssl”：“必需的”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “status”：“OK_NO_TOLERANCE”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “statusText”：“群集不能容忍任何失败。”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “拓扑”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “localhost：3310”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“localhost：3310”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “模式”：“R / W”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “readReplicas”：{}， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “状态”：“在线”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “localhost：3320”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“localhost：3320”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “模式”：“R / O”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “readReplicas”：{}， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “状态”：“在线”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “groupInformationSourceMember”：“mysql：// root @ localhost：3310”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如何继续操作取决于实例是MySQL Shell运行实例的本地实例还是远程实例，以及实例是否支持自动保持配置更改，请参阅保持
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">设置</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">如果实例支持自动持久更改配置，则无需手动保留设置，可以添加更多实例或继续执行下一步。</font>
								<font style="vertical-align: inherit;">如果实例不支持自动持久配置更改，则必须在本地配置实例。</font>
								<font style="vertical-align: inherit;">请参阅使用
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">这对于确保实例在离开群集时重新加入群集至关重要。
								</font>
							</font>
						</p>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果实例有，
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。</font>
									<font style="vertical-align: inherit;">有关</font>
									<font style="vertical-align: inherit;">详细信息，</font>
									<font style="vertical-align: inherit;">请参阅
									</font>
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									部署集群后，您可以配置MySQL路由器以提供高可用性，请参见
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-using-router" title="21.3将MySQL路由器与InnoDB集群配合使用">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第21.3节“将MySQL路由器与InnoDB集群配合使用”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="section">
					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-sandbox-deployment"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.5 InnoDB集群的沙箱部署</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								本节介绍如何设置沙箱InnoDB集群部署。</font>
							<font style="vertical-align: inherit;">您可以使用包含AdminAPI的MySQL Shell创建和管理InnoDB集群。</font>
							<font style="vertical-align: inherit;">本节假设您熟悉MySQL Shell，请参阅
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/" target="_top">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">MySQL Shell 8.0（MySQL 8.0的一部分）</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">以获取更多信息。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								最初部署和使用MySQL的本地沙箱实例是开始探索InnoDB集群的好方法。</font>
							<font style="vertical-align: inherit;">在生产服务器上部署之前，您可以在本地完全测试InnoDB集群。</font>
							<font style="vertical-align: inherit;">MySQL Shell具有内置功能，用于创建正确配置为在本地部署方案中使用组复制的沙箱实例。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									沙箱实例仅适用于在本地计算机上部署和运行以进行测试。</font>
								<font style="vertical-align: inherit;">在生产环境中，MySQL Server实例部署到网络上的各种主机。</font>
								<font style="vertical-align: inherit;">有关</font>
								<font style="vertical-align: inherit;">
									更多信息</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment"
							 title="21.2.4 InnoDB集群的生产部署">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">，</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">请参见
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-production-deployment"
								 title="21.2.4 InnoDB集群的生产部署">
									<font style="vertical-align: inherit;">第21.2.4节“InnoDB集群的生产部署”</font>
								</a>
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">


									部署沙箱实例时，将创建本地目录并</font>
								<font style="vertical-align: inherit;">存储</font>
							</font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">mysqld</font>
										</font>
									</strong></span></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">的副本</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">此副本与部署沙箱时安装的当前MySQL服务器版本相匹配。</font>
								<font style="vertical-align: inherit;">因此，</font>
								<font style="vertical-align: inherit;">用于沙箱</font>
								<font style="vertical-align: inherit;">的</font>
							</font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">mysqld</font>
										</font>
									</strong></span></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">版本</font>
								<font style="vertical-align: inherit;">是固定的，如果您随后升级已安装的MySQL版本，则不会更改。</font>
								<font style="vertical-align: inherit;">由于沙盒实例被认为是瞬态的并且用于测试，因此最快的解决方案是在升级MySQL之后部署新的沙箱实例之前删除在旧版本上构建的所有沙箱。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								本教程介绍如何使用MySQL Shell创建由三个MySQL服务器实例组成的InnoDB集群。
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p><a class="xref" href="mysql-innodb-cluster-userguide.html#deploy-sandbox-instances" title="部署沙箱实例">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">部署沙箱实例</font>
										</font>
									</a></p>
							</li>
							<li class="listitem">
								<p><a class="xref" href="mysql-innodb-cluster-userguide.html#create-innodb-cluster" title="创建Sandbox InnoDB集群">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">创建Sandbox InnoDB集群</font>
										</font>
									</a></p>
							</li>
							<li class="listitem">
								<p><a class="xref" href="mysql-innodb-cluster-userguide.html#add-instances-innodb-cluster" title="将实例添加到InnoDB群集">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">将实例添加到InnoDB群集</font>
										</font>
									</a></p>
							</li>
							<li class="listitem">
								<p><a class="xref" href="mysql-innodb-cluster-userguide.html#persist-configuration-innodb-cluster" title="坚持沙箱配置">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">坚持沙箱配置</font>
										</font>
									</a></p>
							</li>
						</ul>
					</div>

					<div class="simplesect">

						<div class="titlepage">
							<div>

								<div class="simple">
									<h4 class="title"><a name="deploy-sandbox-instances"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">部署沙箱实例</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									MySQL Shell包含添加</font>
							</font><code class="literal">dba</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">全局变量</font>
								<font style="vertical-align: inherit;">的AdminAPI，该
								</font>
								<font style="vertical-align: inherit;">变量提供管理沙箱实例的功能。</font>
								<font style="vertical-align: inherit;">在此示例设置中，您将使用创建三个沙箱实例
								</font>
							</font><code class="literal">dba.deploySandboxInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									通过发出命令从命令提示符启动MySQL Shell：
								</font>
							</font>
						</p>
						<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlsh</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									除了本机SQL模式之外，MySQL Shell还提供两种脚本语言模式，JavaScript和Python。</font>
								<font style="vertical-align: inherit;">在本指南中，MySQL Shell主要用于JavaScript模式。</font>
								<font style="vertical-align: inherit;">当MySQL Shell启动时，它默认处于JavaScript模式。</font>
								<font style="vertical-align: inherit;">通过发布</font>
							</font><code class="literal">\js</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">JavaScript模式，</font>
							</font><code class="literal">\py</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">Python模式和
								</font>
							</font><code class="literal">\sql</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">SQL模式来</font>
								<font style="vertical-align: inherit;">切换</font>
								<font style="vertical-align: inherit;">模式。</font>
								<font style="vertical-align: inherit;">通过发出</font>
							</font><code class="literal">\js</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">命令</font>
								<font style="vertical-align: inherit;">确保您处于JavaScript模式</font>
								<font style="vertical-align: inherit;">，然后执行：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.deploySandboxInstance(3310)</code></strong>
</pre>
						<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										注意
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										在JavaScript和Python模式下，不需要使用分号终止命令。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									传递给的参数
								</font>
							</font><code class="literal">deploySandboxInstance()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">是MySQL服务器实例侦听连接的TCP端口号。</font>
								<font style="vertical-align: inherit;">默认情况下，沙箱是</font>
								<font style="vertical-align: inherit;">
									在Unix系统上</font>
								<font style="vertical-align: inherit;">命名的目录中创建的
								</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">对于Microsoft Windows系统，目录是
								</font>
								<font style="vertical-align: inherit;">。
								</font>
							</font><code class="literal">$HOME/mysql-sandboxes/<em class="replaceable"><code>port</code></em></code>
							<font style="vertical-align: inherit;"></font><code class="literal">%userprofile%\MySQL\mysql-sandboxes\<em
								 class="replaceable"><code>port</code></em></code>
							<font style="vertical-align: inherit;"></font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									将提示用户的root用户密码。
								</font>
							</font>
						</p>
						<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										重要
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										每个实例都有自己的密码。</font>
									<font style="vertical-align: inherit;">在本教程中为所有沙箱定义相同的密码使其更容易，但请记住在生产部署中为每个实例使用不同的密码。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要部署其他沙箱服务器实例，请在端口3310处重复沙盒实例所遵循的步骤，选择不同的端口号。</font>
								<font style="vertical-align: inherit;">对于每个其他沙盒实例问题：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.deploySandboxInstance(<em class="replaceable"><code>port_number</code></em>)</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要学习本教程，请为三个沙盒服务器实例使用端口号3310,3320和3330。</font>
								<font style="vertical-align: inherit;">问题：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; </font><font style="vertical-align: inherit;">
mysql-js&gt;</font></font><strong class="userinput"><code>dba.deploySandboxInstance(<em class="replaceable"><code>3320</code></em>)</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>dba.deploySandboxInstance(<em class="replaceable"><code>3330</code></em>)</code></strong>
</pre>
					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="create-innodb-cluster"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">创建Sandbox InnoDB集群</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									下一步是在连接到种子MySQL Server实例时创建InnoDB集群。</font>
								<font style="vertical-align: inherit;">种子实例包含要复制到其他实例的数据。</font>
								<font style="vertical-align: inherit;">在此示例中，沙箱实例为空，因此我们可以选择任何实例。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									将MySQL Shell连接到种子实例，在本例中是端口3310处的实例：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>\connect root@localhost:3310</code></strong></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									的</font>
							</font><code class="literal">\connect</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">MySQL的Shell命令是针对一个快捷方式</font>
							</font><code class="literal">shell.connect()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">的方法：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>shell.connect('user@localhost:3310')</code></strong>
</pre>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										尝试使用主机名解析为与真实网络接口不匹配的IP地址的实例失败。</font>
									<font style="vertical-align: inherit;">请参见
									</font>
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-limitations" title="21.5已知限制">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">第21.5节“已知限制”</font>
									</font>
								</a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									连接后，AdminAPI可以写入本地实例的选项文件。</font>
								<font style="vertical-align: inherit;">这与使用生产部署不同，在生产部署中，您需要将设置保留到实例的选项文件中。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									使用该</font>
							</font><code class="literal">dba.createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">方法创建InnoDB集群，并将当前连接的实例作为种子：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>var cluster = dba.createCluster('testCluster')</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									该</font>
							</font><code class="literal">createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">方法将InnoDB集群元数据部署到所选实例，并将当前连接的实例添加为种子实例。</font>
								<font style="vertical-align: inherit;">该</font>
							</font><code class="literal">createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">方法返回创建的集群，在上面的示例中，它被分配给</font>
							</font><code class="literal">cluster</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">变量。</font>
							</font><code class="literal">createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									在这种情况下，</font>
								<font style="vertical-align: inherit;">传递给该</font>
								<font style="vertical-align: inherit;">方法</font>
								<font style="vertical-align: inherit;">的参数</font>
								<font style="vertical-align: inherit;">是赋予此InnoDB集群的符号名称</font>
							</font><code class="literal">testCluster</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果实例有，
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
									</font>
								</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。</font>
									<font style="vertical-align: inherit;">有关</font>
									<font style="vertical-align: inherit;">详细信息，</font>
									<font style="vertical-align: inherit;">请参阅
									</font>
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>

					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="add-instances-innodb-cluster"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">将实例添加到InnoDB群集</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									下一步是向InnoDB集群添加更多实例。</font>
								<font style="vertical-align: inherit;">每个辅助实例在添加时都会重新执行由种子实例执行的任何事务。</font>
								<font style="vertical-align: inherit;">本教程使用先前在端口3320和3330创建的沙箱实例。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									最近创建了此示例中的种子实例，因此它几乎为空。</font>
								<font style="vertical-align: inherit;">因此，几乎没有数据需要从种子实例复制到辅助实例。</font>
								<font style="vertical-align: inherit;">在生产环境中，种子实例上有现有数据库，您可以使用MySQL Enterprise Backup等工具确保辅助数据在复制开始之前具有匹配的数据。</font>
								<font style="vertical-align: inherit;">这避免了数据从主数据库复制到辅助数据库时长时间延迟的可能性。</font>
								<font style="vertical-align: inherit;">请参见
								</font>
							</font><a class="xref" href="group-replication.html#group-replication-enterprise-backup" title="18.4.7将MySQL企业备份与组复制一起使用">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第18.4.7节“将MySQL企业备份与组复制一起使用”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									将第二个实例添加到InnoDB集群：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.addInstance('root@localhost:3320')</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									提示输入root用户的密码。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									添加第三个实例：
								</font>
							</font>
						</p>
						<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.addInstance('root@localhost:3330')</code></strong>
</pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									提示输入root用户的密码。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									此时，您已创建了一个包含三个实例的集群：一个主服务器和两个辅助服务器。
								</font>
							</font>
						</p>
						<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

							<div class="admon-title">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										小费
									</font>
								</font>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										只能指定</font>
								</font><code class="literal">localhost</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">在
									</font>
								</font><code class="literal">addInstance()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">如果实例是一个沙箱实例。</font>
									<font style="vertical-align: inherit;">这也适用于</font>
								</font><code class="literal">addInstance()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">发布后
									</font>
									<font style="vertical-align: inherit;">的隐含
									</font>
								</font><code class="literal">createCluster()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。
									</font>
								</font>
							</p>
						</div>

					</div>
					<div class="simplesect">
						<div class="titlepage">
							<div>
								<div class="simple">
									<h4 class="title"><a name="persist-configuration-innodb-cluster"></a>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">坚持沙箱配置</font>
										</font>
									</h4>

								</div>

							</div>

						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									将沙箱实例添加到群集后，必须将InnoDB群集所需的配置保留到每个实例的选项文件中。</font>
								<font style="vertical-align: inherit;">如何继续取决于实例是否支持自动持久配置更改，请参阅“
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">持久设置”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">当您使用的MySQL实例支持持久更改配置时，添加实例会自动配置实例。</font>
								<font style="vertical-align: inherit;">当您使用的MySQL实例不支持自动持久配置更改时，您必须在本地配置实例。</font>
								<font style="vertical-align: inherit;">请参阅使用
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">配置实例
									</font>
								</font><code class="literal">dba.configureLocalInstance()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要检查是否已创建群集，请使用群集实例的</font>
							</font><code class="literal">status()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">功能。</font>
								<font style="vertical-align: inherit;">请参阅使用
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#check-innodb-cluster-status" title="使用Cluster.status（）检查集群的状态">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">检查群集的状态
									</font>
								</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									部署集群后，您可以配置MySQL路由器以提供高可用性，请参见
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-using-router" title="21.3将MySQL路由器与InnoDB集群配合使用">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">第21.3节“将MySQL路由器与InnoDB集群配合使用”</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="section">
					<div class="titlepage">
						<div>
							<div>
								<h3 class="title"><a name="mysql-innodb-cluster-from-group-replication"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">21.2.6采用组复制部署</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果您具有组复制的现有部署，并且希望使用它来创建集群，请将该</font>
						</font><code class="literal">adoptFromGR</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递
							</font>
							<font style="vertical-align: inherit;">给该
							</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">函数。</font>
							<font style="vertical-align: inherit;">创建的InnoDB集群会匹配复制组是以单主数据库还是多主数据库运行。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要采用现有的组复制组，请使用MySQL Shell连接到组成员。</font>
							<font style="vertical-align: inherit;">在以下示例中，采用单主组。</font>
							<font style="vertical-align: inherit;">我们连接到
							</font>
						</font><code class="literal">gr-member-2</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">辅助实例，同时
							</font>
						</font><code class="literal">gr-member-1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">作为组的主要功能。</font>
							<font style="vertical-align: inherit;">使用</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">传入
							</font>
						</font><code class="literal">adoptFromGR</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">创建集群
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  
MySQL的-JS&gt; </font></font><strong class="userinput"><code>var cluster = dba.createCluster('prodCluster', {adoptFromGR: true});</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将在实例'root @ gr-member-2：3306'上创建一个新的InnoDB集群。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在'root @ gr-member-2：3306'上创建InnoDB集群'prodCluster'...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添加种子实例...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
群集已成功创建。</font><font style="vertical-align: inherit;">使用cluster.addInstance（）添加MySQL实例。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
至少需要3个实例才能使集群能够承受最多</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一台服务器故障。</font></font><font></font>
</pre>
					<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									小费
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果实例有，
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">有关</font>
								<font style="vertical-align: inherit;">详细信息，</font>
								<font style="vertical-align: inherit;">请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">超级只读和实例</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								新群集与组的模式匹配。</font>
							<font style="vertical-align: inherit;">如果采用的组以单主模式运行，则会创建单主群集。</font>
							<font style="vertical-align: inherit;">如果采用的组以多主模式运行，则会创建多主集群。
							</font>
						</font>
					</p>
				</div>

			</div>
			<div class="section">
				<div class="titlepage">
					<div>
						<div>
							<h2 class="title" style="clear: both"><a name="mysql-innodb-cluster-using-router"></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.3将MySQL路由器与InnoDB集群配合使用</font>
								</font>
							</h2>

						</div>

					</div>

				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							本节介绍如何使用带有InnoDB集群的MySQL路由器来实现高可用性。</font>
						<font style="vertical-align: inherit;">无论您是否部署了沙箱或生产群集，MySQL路由器都可以使用该</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
					 target="_top"><code class="option">--bootstrap</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项</font>
						<font style="vertical-align: inherit;">基于InnoDB群集的元数据进行自我配置
						</font>
						<font style="vertical-align: inherit;">。</font>
						<font style="vertical-align: inherit;">这会自动配置MySQL路由器以将连接路由到群集的服务器实例。</font>
						<font style="vertical-align: inherit;">客户端应用程序连接到MySQL路由器提供的端口，无需了解InnoDB集群拓扑。</font>
						<font style="vertical-align: inherit;">如果发生意外故障，InnoDB集群会自动调整，MySQL Router会检测到更改。</font>
						<font style="vertical-align: inherit;">这消除了客户端应用程序处理故障转移的需要。</font>
						<font style="vertical-align: inherit;">有关更多信息，请参阅
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-innodb-cluster.html"
					 target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">MySQL InnoDB集群的路由</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。
						</font>
					</font>
				</p>
				<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

					<div class="admon-title">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								注意
							</font>
						</font>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								不要尝试手动配置MySQL路由器以重定向到InnoDB集群的端口。</font>
							<font style="vertical-align: inherit;">始终使用该
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
						 target="_top"><code class="option">--bootstrap</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项，因为这可确保MySQL路由器从InnoDB集群的元数据中获取其配置。</font>
							<font style="vertical-align: inherit;">请参阅
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-general-metadata.html"
						 target="_top">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">群集元数据和状态</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							建议的MySQL路由器部署与应用程序位于同一主机上。</font>
						<font style="vertical-align: inherit;">使用沙箱部署时，所有内容都在单个主机上运行，​​因此您将MySQL路由器部署到同一主机。</font>
						<font style="vertical-align: inherit;">使用生产部署时，我们建议将一个MySQL路由器实例部署到用于托管其中一个客户端应用程序的每台计算机上。</font>
						<font style="vertical-align: inherit;">还可以将MySQL路由器部署到应用程序实例连接的公共计算机。
						</font>
					</font>
				</p>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							假设已经</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-installation.html" target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">安装了MySQL路由器</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">（请参阅
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-installation.html"
						 target="_top">
							<font style="vertical-align: inherit;">安装MySQL路由器</font>
						</a>
						<font style="vertical-align: inherit;">），请使用该
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
					 target="_top"><code class="option">--bootstrap</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项提供属于InnoDB群集的服务器实例的位置。</font>
						<font style="vertical-align: inherit;">MySQL路由器检索InnoDB集群的元数据，包括组成集群的服务器实例地址列表及其在集群中的角色。</font>
						<font style="vertical-align: inherit;">您传递MySQL路由器应从中检索InnoDB群集元数据的服务器的URI类型字符串。</font>
						<font style="vertical-align: inherit;">例如：
						</font>
					</font>
				</p>
				<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlrouter --bootstrap ic@ic-1:3306 --user=mysqlrouter </code></strong>
</pre>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							系统将提示您输入要使用的MySQL路由器的实例密码和加密密钥。</font>
						<font style="vertical-align: inherit;">此加密密钥用于加密MySQL路由器用于连接到群集的实例密码。</font>
						<font style="vertical-align: inherit;">还会显示可用于连接InnoDB群集的端口。</font>
						<font style="vertical-align: inherit;">在上面的示例中，</font>
						<font style="vertical-align: inherit;">MySQL路由器引导过程创建了一个
						</font>
					</font><code class="filename">mysqlrouter.conf</code>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">文件，其中的设置基于从传递给该</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
					 target="_top"><code class="option">--bootstrap</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项</font>
						<font style="vertical-align: inherit;">的地址中检索到的集群元数据</font>
					</font><code class="literal">ic@ic-1:3306</code>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。</font>
						<font style="vertical-align: inherit;">基于检索到的InnoDB集群元数据，MySQL路由器自动配置</font>
					</font><code class="filename">mysqlrouter.conf</code>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">文件，包括</font>
						<font style="vertical-align: inherit;">
							包含集群中所有服务器实例的地址</font>
						<font style="vertical-align: inherit;">的</font>
					</font><code class="literal">metadata_cache</code>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">部分
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-conf-options.html#option_mysqlrouter_bootstrap_server_addresses"
					 target="_top"><code class="option">bootstrap_server_addresses</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。</font>
						<font style="vertical-align: inherit;">例如：
						</font>
					</font>
				</p>
				<pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[metadata_cache：prodCluster]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Router_ID与= 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bootstrap_server_addresses = MySQL的：// IC @ IC-1：3306，MySQL的：// IC @ IC-2：3306，MySQL的：// IC @ IC-3：3306</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用户= mysql_router1_jy95yozko3k2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
metadata_cluster = prodCluster</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TTL = 300</font></font><font></font>
</pre>
				<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

					<div class="admon-title">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								小费
							</font>
						</font>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								通过在引导MySQL路由器之后添加另一个服务器实例来更改群集的拓扑时，需要
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-conf-options.html#option_mysqlrouter_bootstrap_server_addresses"
						 target="_top"><code class="option">bootstrap_server_addresses</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								根据更新的元数据进行更新。</font>
							<font style="vertical-align: inherit;">使用该</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
						 target="_top"><code class="option">--bootstrap</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">重新启动MySQL路由器
							</font>
							<font style="vertical-align: inherit;">，或手动编辑</font>
							<font style="vertical-align: inherit;">文件</font>
							<font style="vertical-align: inherit;">的
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-conf-options.html#option_mysqlrouter_bootstrap_server_addresses"
						 target="_top"><code class="option">bootstrap_server_addresses</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								部分</font>
						</font><code class="filename">mysqlrouter.conf</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">并重新启动MySQL路由器。
							</font>
						</font>
					</p>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							生成的MySQL路由器配置会创建用于连接到群集的TCP端口。</font>
						<font style="vertical-align: inherit;">创建使用经典MySQL协议和X协议与群集通信的端口。</font>
						<font style="vertical-align: inherit;">要使用X协议，服务器实例必须安装并配置X插件。</font>
						<font style="vertical-align: inherit;">对于沙箱部署，实例会自动设置X插件。</font>
						<font style="vertical-align: inherit;">对于生产部署，如果要使用X协议，则需要在每个实例上安装和配置X插件，请参阅
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-install.html" target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">安装MySQL Shell</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。</font>
						<font style="vertical-align: inherit;">默认的可用TCP端口是：
						</font>
					</font>
				</p>
				<div class="itemizedlist">
					<ul class="itemizedlist" style="list-style-type: disc; ">
						<li class="listitem">
							<p>
								<code class="literal">6446</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;"> - 对于经典MySQL协议读写会话，MySQL路由器将传入连接重定向到主服务器实例。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<code class="literal">6447</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;"> - 对于经典MySQL协议只读会话，MySQL路由器将传入连接重定向到其中一个辅助服务器实例。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<code class="literal">64460</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;"> - 对于X协议读写会话，MySQL路由器将传入连接重定向到主服务器实例。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<code class="literal">64470</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;"> - 对于X协议只读会话，MySQL路由器将传入连接重定向到其中一个辅助服务器实例。
									</font>
								</font>
							</p>
						</li>
					</ul>
				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							根据您的MySQL路由器配置，端口号可能与上述不同。</font>
						<font style="vertical-align: inherit;">例如，如果您使用
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_conf-base-port"
					 target="_top"><code class="option">--conf-base-port</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项或
						</font>
					</font><a class="link" href="group-replication.html#sysvar_group_replication_single_primary_mode"><code class="literal">group_replication_single_primary_mode</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							变量。</font>
						<font style="vertical-align: inherit;">启动MySQL路由器时会列出确切的端口。
						</font>
					</font>
				</p>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							传入连接的重定向方式取决于所使用的群集类型。</font>
						<font style="vertical-align: inherit;">使用单主群集时，默认情况下，MySQL路由器会发布X协议和经典协议端口，客户端连接到这些端口以进行读写会话，并重定向到群集的单个主节点。</font>
						<font style="vertical-align: inherit;">使用多主群集时，读写会话将以循环方式重定向到其中一个主要实例。</font>
						<font style="vertical-align: inherit;">例如，这意味着到端口6446的第一个连接将被重定向到ic-1实例，到端口6446的第二个连接将被重定向到ic-2实例，依此类推。</font>
						<font style="vertical-align: inherit;">对于传入的只读连接，MySQL路由器还以循环方式将连接重定向到其中一个辅助实例。</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-conf-options.html#option_mysqlrouter_routing_strategy"
					 target="_top"><code class="option">routing_strategy</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							选项。
						</font>
					</font>
				</p>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							一旦引导和配置，启动MySQL路由器。</font>
						<font style="vertical-align: inherit;">如果您使用带有该</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
					 target="_top"><code class="option">--bootstrap</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项</font>
						<font style="vertical-align: inherit;">的系统范围安装，
						</font>
						<font style="vertical-align: inherit;">则发出：
						</font>
					</font>
				</p>
				<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlrouter &amp;</code></strong>
</pre>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							如果使用该</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_directory"
					 target="_top"><code class="option">--directory</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">选项</font>
						<font style="vertical-align: inherit;">将MySQL路由器安装到目录
						</font>
						<font style="vertical-align: inherit;">，请使用</font>
					</font><code class="filename">start.sh</code>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">您安装目录中</font>
						<font style="vertical-align: inherit;">的
						</font>
						<font style="vertical-align: inherit;">脚本。</font>
						<font style="vertical-align: inherit;">或者设置服务以在系统引导时自动启动MySQL路由器，请参阅
						</font>
					</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-server-starting.html"
					 target="_top">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">启动MySQL路由器</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。</font>
						<font style="vertical-align: inherit;">现在，您可以将MySQL客户端（如MySQL
							Shell）连接到其中一个传入的MySQL路由器端口，如上所述，并查看客户端如何透明地连接到其中一个InnoDB集群实例。
						</font>
					</font>
				</p>
				<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlsh --uri root@localhost:6442</code></strong>
</pre>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							要验证您实际连接到哪个实例，只需针对</font>
					</font><a class="link" href="server-administration.html#sysvar_port"><code class="literal">port</code></a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">状态变量</font>
						<font style="vertical-align: inherit;">发出SQL查询
						</font>
						<font style="vertical-align: inherit;">。


						</font>
					</font>
				</p>
				<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>\sql</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
切换到SQL模式...命令以;结尾;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的-SQL&gt; </font></font><strong class="userinput"><code>select @@port;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ port |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3310 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font>
</pre>
				<div class="simplesect">

					<div class="titlepage">
						<div>

							<div class="simple">
								<h3 class="title"><a name="test-failover"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">测试高可用性</font>
									</font>
								</h3>
							</div>
						</div>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要测试高可用性是否有效，请通过终止实例来模拟意外停止。</font>
							<font style="vertical-align: inherit;">群集检测到实例离开群集并重新配置自身的事实。</font>
							<font style="vertical-align: inherit;">群集重新配置的确切方式取决于您使用的是单主群集还是多主群集，以及实例在群集中所服务的角色。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在单主模式下：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果当前主节点离开集群，则其中一个辅助实例被选为新主节点，其中实例按最低值排列优先级
										</font>
									</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">MySQL路由器将读写连接重定向到新选择的主节点。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果当前辅助节点离开群集，MySQL路由器将停止将只读连接重定向到该实例。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								有关更多信息，请参见
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-single-primary-mode" title="18.4.1.1单主模式">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.4.1.1节“单主模式”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在多主模式下：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果当前“R / W”实例离开群集，MySQL路由器会将读写连接重定向到其他原色。</font>
										<font style="vertical-align: inherit;">如果离开的实例是群集中的最后一个主节点，则群集完全消失，您无法连接到任何MySQL路由器端口。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								有关更多信息，请参见
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-multi-primary-mode" title="18.4.1.2多主模式">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.4.1.2节“多主模式”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								有多种方法可以模拟离开集群的实例，例如，您可以强制停止实例上的MySQL服务器，或者在</font>
						</font><code class="literal">dba.killSandboxInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">测试沙箱部署时</font>
							<font style="vertical-align: inherit;">使用AdminAPI
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">在此示例中，假设存在具有三个服务器实例的单主要沙箱集群部署，并且在端口3310处侦听的实例是当前主要部署。</font>
							<font style="vertical-align: inherit;">模拟意外离开集群的实例：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.killSandboxInstance(3310)</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								群集会检测到更改并自动选择新的主数据库。</font>
							<font style="vertical-align: inherit;">假设您的会话连接到端口6446（默认的读写经典MySQL协议端口），MySQL路由器应检测到群集拓扑的更改并将会话重定向到新选择的主节点。</font>
							<font style="vertical-align: inherit;">要验证这一点，请使用该</font>
						</font><code class="literal">\sql</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令</font>
							<font style="vertical-align: inherit;">在MySQL Shell中切换到SQL模式，
							</font>
							<font style="vertical-align: inherit;">然后选择实例的
							</font>
						</font><a class="link" href="server-administration.html#sysvar_port"><code class="literal">port</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">变量以检查会话被重定向到的实例。</font>
							<font style="vertical-align: inherit;">注意第一个</font>
						</font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">语句失败，因为与原始主节点的连接丢失。</font>
							<font style="vertical-align: inherit;">这意味着当前会话已关闭，MySQL Shell会自动为您重新连接，当您再次发出命令时，将确认新端口。
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>\sql</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
切换到SQL模式...命令以;结尾;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的-SQL&gt; </font></font><strong class="userinput"><code>SELECT @@port;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误：2013（HY000）：查询期间与MySQL服务器的连接丢失</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全局会话断开了。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
试图重新连接到'root @ localhost：6446'...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全球会议已成功重新连接。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的-SQL&gt; </font></font><strong class="userinput"><code>SELECT @@port;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ port |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3330 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在此示例中，端口3330处的实例已被选为新主节点。</font>
							<font style="vertical-align: inherit;">这表明InnoDB集群为我们提供了自动故障转移，MySQL路由器自动将我们重新连接到新的主要实例，并且我们具有高可用性。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="router-and-metadata-servers"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">MySQL路由器和元数据服务器</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当MySQL路由器针对群集进行引导时，它会在其配置文件中记录服务器实例的地址。</font>
							<font style="vertical-align: inherit;">如果在引导MySQL路由器之后将任何其他实例添加到群集，则不会自动检测它们，因此</font>
						</font><span class="emphasis"><em>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">不会</font>
								</font>
							</em></span>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">将它们用于连接路由。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要确保新添加的实例正确路由，您必须针对群集引导MySQL路由器以读取更新的元数据。</font>
							<font style="vertical-align: inherit;">这意味着您必须重新启动MySQL路由器并包含该</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-router/8.0/en/mysqlrouter.html#option_mysqlrouter_bootstrap"
						 target="_top"><code class="option">--bootstrap</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项。
							</font>
						</font>
					</p>
				</div>

			</div>
			<div class="section">
				<div class="titlepage">
					<div>
						<div>
							<h2 class="title" style="clear: both"><a name="mysql-innodb-cluster-working-with-cluster"></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.4使用InnoDB集群</font>
								</font>
							</h2>

						</div>

					</div>

				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							本节介绍如何使用InnoDB集群，以及如何处理常见的管理任务。


						</font>
					</font>
				</p>
				<div class="itemizedlist">
					<ul class="itemizedlist" style="list-style-type: disc; ">
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#check-instance-configuration" title="使用dba.checkInstanceConfiguration（）">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">运用 </font>
									</font><code class="literal">dba.checkInstanceConfiguration()</code>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-local-instances" title="使用dba.configureLocalInstance（）配置实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">使用配置实例
										</font>
									</font><code class="literal">dba.configureLocalInstance()</code>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#retrieving-an-innodb-cluster" title="使用dba.getCluster（）检索InnoDB集群">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">用。检索InnoDB集群 </font>
									</font><code class="literal">dba.getCluster()</code>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#check-innodb-cluster-status" title="使用Cluster.status（）检查集群的状态">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">使用检查群集的状态
										</font>
									</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#innodb-cluster-group-replication-protocol" title="InnoDB集群和组复制协议">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">InnoDB集群和组复制协议</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#describe-structure-innodb-cluster" title="使用cluster.describe（）">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">运用 </font>
									</font><code class="literal">cluster.describe()</code>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#checking-version-on-instances" title="在实例上检查MySQL版本">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">在实例上检查MySQL版本</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-automatic-rejoin-of-instances" title="配置实例的自动重新加入">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置实例的自动重新加入</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#manage-sandbox-instances" title="管理沙箱实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">管理沙箱实例</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#remove-instances-from-innodb-cluster" title="从InnoDB集群中删除实例">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从InnoDB集群中删除实例</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#customize-your-cluster" title="自定义InnoDB集群">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">自定义InnoDB集群</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#rejoin-cluster" title="重新加入群集">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">重新加入群集</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#restore-cluster-from-quorum-loss" title="从仲裁丢失中恢复群集">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从仲裁丢失中恢复群集</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#reboot-outage" title="从主要中断重新启动群集">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从主要中断重新启动群集</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#rescan-cluster" title="重新扫描群集">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">重新扫描群集</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#check-instance-state" title="检查实例状态">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">检查实例状态</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#dissolve-innodb-cluster" title="解散InnoDB集群">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">解散InnoDB集群</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-securing" title="保护您的群集">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">保护您的群集</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#create-whitelist-servers" title="创建服务器白名单">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">创建服务器白名单</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#use-mysql-shell-execute-script" title="编写AdminAPI脚本">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">编写AdminAPI脚本</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#configuring-election-process" title="配置选举过程">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置选举过程</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-failover-consistency" title="配置故障转移一致性">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置故障转移一致性</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-change-topology" title="更改群集的拓扑">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">更改群集的拓扑</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-setting-options" title="设置InnoDB集群的选项">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">设置InnoDB集群的选项</font>
									</font>
								</a></p>
						</li>
						<li class="listitem">
							<p><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-auto-increment" title="InnoDB集群和自动增量">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">InnoDB集群和自动增量</font>
									</font>
								</a></p>
						</li>
					</ul>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="check-instance-configuration"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">运用 </font>
									</font><code class="literal">dba.checkInstanceConfiguration()</code>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609736432"></a><a class="indexterm" name="idm140091609734928"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在从服务器实例创建生产部署之前，您需要检查每个实例上的MySQL是否已正确配置。</font>
							<font style="vertical-align: inherit;">除了
							</font>
						</font><code class="literal">dba.configureInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在配置实例时检查配置，您还可以使用该</font>
						</font><code class="literal">dba.checkInstanceConfiguration()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								功能。</font>
							<font style="vertical-align: inherit;">这可确保实例满足
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-requirements" title="21.2.2 InnoDB集群要求">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第21.2.2节“InnoDB群集要求”，</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">而无需更改实例上的任何配置。</font>
							<font style="vertical-align: inherit;">这不会</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#check-instance-state" title="检查实例状态">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">检查实例</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">上的任何数据，请参阅
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#check-instance-state" title="检查实例状态">
								<font style="vertical-align: inherit;">检查实例状态</font>
							</a>
							<font style="vertical-align: inherit;">以获取更多信息。</font>
							<font style="vertical-align: inherit;">以下演示了在运行的MySQL Shell中发布它：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>dba.checkInstanceConfiguration('ic@ic-1:3306')</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请提供“ic @ ic-1：3306”的密码：***</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
验证ic-1：3306上的MySQL实例，以便在InnoDB集群中使用...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此实例将其自己的地址报告为ic-1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
默认情况下，客户端和其他集群成员将通过此地址与其进行通信。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果这不正确，则应更改report_host MySQL系统变量。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查现有表是否符合组复制要求...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
未检测到不兼容的表</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查实例配置...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
需要修复一些配置选项：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------------------------- + -------- + ------ ---------- + --------------------------------------- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">变量| </font><font style="vertical-align: inherit;">当前价值| </font><font style="vertical-align: inherit;">必需值| </font><font style="vertical-align: inherit;">注意|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------------------------- + -------- + ------ ---------- + --------------------------------------- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog_checksum | </font><font style="vertical-align: inherit;">CRC32 | </font><font style="vertical-align: inherit;">没有| </font><font style="vertical-align: inherit;">更新服务器变量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">enforce_gtid_consistency | </font><font style="vertical-align: inherit;">关闭| </font><font style="vertical-align: inherit;">ON | </font><font style="vertical-align: inherit;">更新只读变量并重新启动服务器</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">gtid_mode | </font><font style="vertical-align: inherit;">关闭| </font><font style="vertical-align: inherit;">ON | </font><font style="vertical-align: inherit;">更新只读变量并重新启动服务器</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">server_id | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">更新只读变量并重新启动服务器</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ -------------------------- + -------- + ------ ---------- + --------------------------------------- ----------- +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请使用dba.configureInstance（）命令来修复这些问题。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “config_errors”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “action”：“server_update”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “当前”：“CRC32”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “option”：“binlog_checksum”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “必需”：“无”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “当前”：“关闭”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “选项”：“enforce_gtid_consistency”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “必需”：“开”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “当前”：“关闭”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “选项”：“gtid_mode”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “必需”：“开”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “行动”：“重启”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “当前”：“1”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “option”：“server_id”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “必需”：“”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “状态”：“错误”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								对计划用作群集一部分的每个服务器实例重复此过程。</font>
							<font style="vertical-align: inherit;">运行后生成的报告
							</font>
						</font><code class="literal">dba.checkInstanceConfiguration()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">提供有关所需的任何配置更改的信息，然后才能继续。</font>
							<font style="vertical-align: inherit;">该</font>
						</font><code class="literal">action</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">领域
							</font>
						</font><code class="literal">config_error</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">的报告的部分告诉你的MySQL的实例是否需要重新启动才能检测对配置文件进行任何改变。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="configuring-local-instances"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">使用配置实例
										</font>
									</font><code class="literal">dba.configureLocalInstance()</code>
								</h3>
							</div>
						</div>
					</div>
					<a class="indexterm" name="idm140091609720848"></a><a class="indexterm" name="idm140091609719344"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								不支持持久配置更改的实例（请参阅
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">持久设置</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">）要求您连接到服务器，运行MySQL Shell，在本地连接到实例并发出问题
							</font>
						</font><code class="literal">dba.configureLocalInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">这使MySQL Shell能够在针对远程实例运行以下命令后修改实例的选项文件：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">dba.configureInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.createCluster()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.addInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.rejoinInstance()</code>
								</p>
							</li>
						</ul>
					</div>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果未将配置更改持久保存到实例的选项文件，则可能导致实例在下次重新启动后未重新加入群集。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								建议的方法是登录远程计算机，例如使用SSH，以root用户身份运行MySQL Shell，然后连接到本地MySQL服务器。</font>
							<font style="vertical-align: inherit;">例如，使用
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysqlsh.html#option_mysqlsh_uri"
						 target="_top"><code class="option">--uri</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项连接到本地</font>
						</font><em class="replaceable"><code>instance</code></em>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">：
							</font>
						</font>
					</p>
					<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>sudo -i mysqlsh --uri=<em class="replaceable"><code>instance</code></em></code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								或者，使用该</font>
						</font><code class="literal">\connect</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令登录本地实例。</font>
							<font style="vertical-align: inherit;">然后发出
							</font>
							<font style="vertical-align: inherit;">，</font>
							<font style="vertical-align: inherit;">本地实例的连接信息</font>
							<font style="vertical-align: inherit;">在哪里</font>
							<font style="vertical-align: inherit;">，以保持对本地实例的选项文件所做的任何更改。
							</font>
						</font><code class="literal">dba.configureInstance(<em class="replaceable"><code>instance</code></em>)</code>
						<font style="vertical-align: inherit;"></font><em class="replaceable"><code>instance</code></em>
						<font style="vertical-align: inherit;"></font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; dba.configureLocalInstance（'ic @ ic-2：3306'）
	</font></font></pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								对群集中的每个实例重复此过程，该实例不支持自动进行持久配置更改。</font>
							<font style="vertical-align: inherit;">例如，如果向群集添加2个不自动支持持久性配置更改的实例，则必须连接到每个服务器并在实例重新启动之前保留InnoDB群集所需的配置更改。</font>
							<font style="vertical-align: inherit;">同样，如果您修改群集结构（例如更改实例数），则需要为每个服务器实例重复此过程，以便相应地为群集中的每个实例更新InnoDB群集元数据。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="retrieving-an-innodb-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">用。检索InnoDB集群 </font>
									</font><code class="literal">dba.getCluster()</code>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609694576"></a><a class="indexterm" name="idm140091609693088"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								使用时创建集群时
							</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，该操作将返回可以分配给变量的Cluster对象。</font>
							<font style="vertical-align: inherit;">您可以使用此对象来处理群集，例如添加实例或检查群集的状态。</font>
							<font style="vertical-align: inherit;">如果要在以后再次检索群集，例如在重新启动MySQL Shell之后，请使用该
							</font>
							<font style="vertical-align: inherit;">
								功能。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font><code class="literal">dba.getCluster([<em class="replaceable"><code>name</code></em>],[<em class="replaceable"><code>options</code></em>])</code>
						<font style="vertical-align: inherit;"></font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>var cluster1 = dba.getCluster()</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果未指定</font>
						</font><em class="replaceable"><code>name</code></em>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								群集，则返回默认群集。</font>
							<font style="vertical-align: inherit;">默认情况下，MySQL Shell会在您使用时尝试连接到群集的主实例
							</font>
						</font><code class="literal">dba.getCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">设置
							</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项以配置此行为。</font>
							<font style="vertical-align: inherit;">如果</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">是
							</font>
						</font><code class="literal">true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">并且活动的全局MySQL Shell会话不是主实例，则查询群集以查找主要成员，并且群集对象连接到该主要成员。</font>
							<font style="vertical-align: inherit;">如果群集中没有仲裁，则操作将失败。</font>
							<font style="vertical-align: inherit;">如果
							</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">是</font>
						</font><code class="literal">false</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，则群集对象使用活动会话，换句话说，就是与MySQL Shell当前全局会话相同的实例。</font>
							<font style="vertical-align: inherit;">如果
							</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">未指定，MySQL外壳中把</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">作为
							</font>
						</font><code class="literal">true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，并回落到
							</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">是
							</font>
						</font><code class="literal">false</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要在获取群集时强制连接到辅助节点，请建立与群集的辅助成员的连接，并</font>
						</font><code class="literal">connectToPrimary</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">通过发出以下命令来</font>
							<font style="vertical-align: inherit;">使用该</font>
							<font style="vertical-align: inherit;">选项：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; </font></font><strong class="userinput"><code>shell.connect(secondary_member)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql-js&gt;</font></font><strong class="userinput"><code>var cluster1 = dba.getCluster(testCluster, {connectToPrimary:false})</code></strong>
</pre>
					<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									小费
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									请记住，辅助实例具有
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，因此您无法对其进行更改。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="check-innodb-cluster-status"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">使用检查群集的状态
										</font>
									</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
								</h3>
							</div>
						</div>
					</div>
					<a class="indexterm" name="idm140091609667904"></a><a class="indexterm" name="idm140091609665728"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								群集对象提供了</font>
						</font><code class="literal">status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">一种方法，使您可以检查群集的运行方式。</font>
							<font style="vertical-align: inherit;">在检查InnoDB集群的状态之前，您需要通过连接到其任何实例来获取对InnoDB集群对象的引用。</font>
							<font style="vertical-align: inherit;">但是，如果要更改群集的配置，则必须连接到“R / W”实例。</font>
							<font style="vertical-align: inherit;">发出</font>
						</font><code class="literal">status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">将根据您所连接的服务器实例知道的集群视图检索集群的状态并输出状态报告。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									集群中实例的状态直接影响状态报告中提供的信息。</font>
								<font style="vertical-align: inherit;">因此，请确保您连接的实例的状态为
								</font>
							</font><code class="literal">ONLINE</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								有关InnoDB集群如何运行的信息，请使用集群的</font>
						</font><code class="literal">status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; </font></font><strong class="userinput"><code>var cluster = dba.getCluster()</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql-js&gt;</font></font><strong class="userinput"><code>cluster.status()</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “clusterName”：“testcluster”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “defaultReplicaSet”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “名称”：“默认”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “primary”：“ic-1：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “ssl”：“必需的”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “状态”：“好”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “statusText”：“群集在线并且最多可以容忍一次失败。”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “拓扑”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “ic-1：3306”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-1：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “模式”：“R / W”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “readReplicas”：{}， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “状态”：“在线”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “ic-2：3306”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-2：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “模式”：“R / O”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “readReplicas”：{}， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “状态”：“在线”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            “ic-3：3306”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-3：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “模式”：“R / O”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “readReplicas”：{}， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “状态”：“在线”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “groupInformationSourceMember”：“mysql：// ic @ ic-1：3306”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								输出
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								提供以下信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">clusterName</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：在此期间分配给此群集的名称</font>
									</font><code class="literal">dba.createCluster()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">defaultReplicaSet</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：属于InnoDB集群并包含数据集的服务器实例。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">primary</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：仅在群集以单主模式运行时显示。</font>
										<font style="vertical-align: inherit;">显示当前主实例的地址。</font>
										<font style="vertical-align: inherit;">如果未显示此字段，则群集将以多主模式运行。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ssl</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：群集是否使用安全连接。</font>
										<font style="vertical-align: inherit;">显示的值
										</font>
									</font><code class="literal">REQUIRED</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">或者</font>
									</font><code class="literal">DISABLED</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">，这取决于如何</font>
									</font><code class="literal">memberSslMode</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">选择在过程中，可以配置
										</font>
									</font><code class="literal">createCluster()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">或
										</font>
									</font><code class="literal">addInstance()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">此参数返回的值对应于</font>
									</font><a class="link" href="group-replication.html#sysvar_group_replication_ssl_mode"><code class="literal">group_replication_ssl_mode</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											实例上的服务器变量</font>
										<font style="vertical-align: inherit;">的值
										</font>
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">请参阅
										</font>
									</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-securing" title="保护您的群集">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">保护群集</font>
										</font>
									</a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">status</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：群集的此元素的状态。</font>
										<font style="vertical-align: inherit;">对于整个群集，它描述了此群集提供的高可用性。</font>
										<font style="vertical-align: inherit;">状态为以下之一：
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<code class="literal">ONLINE</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：实例处于联机状态并参与群集。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<code class="literal">OFFLINE</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：实例已失去与其他实例的连接。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<code class="literal">RECOVERING</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：实例尝试通过在成为</font>
												</font><code class="literal">ONLINE</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">成员</font>
													<font style="vertical-align: inherit;">之前检索所需的事务来尝试与集群同步
													</font>
													<font style="vertical-align: inherit;">。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<code class="literal">UNREACHABLE</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：实例已丢失与群集的通信。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<code class="literal">ERROR</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：实例在恢复阶段或应用事务时遇到错误。
													</font>
												</font>
											</p>
											<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

												<div class="admon-title">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															重要
														</font>
													</font>
												</div>
												<p>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															实例进入</font>
													</font><code class="literal">ERROR</code>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															状态后，该
														</font>
													</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															选项将设置为</font>
													</font><code class="literal">ON</code>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">。</font>
														<font style="vertical-align: inherit;">要离开
														</font>
													</font><code class="literal">ERROR</code>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">状态，您必须手动配置实例
														</font>
													</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">。
														</font>
													</font>
												</p>
											</div>
										</li>
										<li class="listitem">
											<p>
												<code class="literal">(MISSING)</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">：作为已配置群集的一部分但实际上不可用的实例的状态。
													</font>
												</font>
											</p>
											<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

												<div class="admon-title">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															注意
														</font>
													</font>
												</div>
												<p>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">
															该</font>
													</font><code class="literal">MISSING</code>
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">状态特定于InnoDB集群，它不是Group Replication生成的状态。</font>
														<font style="vertical-align: inherit;">MySQL Shell使用此状态来指示在元数据中注册但在实时群集视图中找不到的实例。
														</font>
													</font>
												</p>
											</div>
										</li>
									</ul>
								</div>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">topology</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：已添加到群集的实例。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Host name of instance</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：实例的主机名，例如localhost：3310。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">role</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：此实例在群集中提供的功能。</font>
										<font style="vertical-align: inherit;">目前只有HA，具有高可用性。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">mode</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：服务器是读写（“R / W”）还是只读（“R / O”）。</font>
										<font style="vertical-align: inherit;">模式表示
										</font>
									</font><code class="literal">R/W</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">（可读和可写）或
										</font>
									</font><code class="literal">R/O</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">（只读）。</font>
										<font style="vertical-align: inherit;">在单主模式下，只有标记为“R / W”的一个实例可以执行更新数据库的事务，因此它是主数据库。</font>
										<font style="vertical-align: inherit;">如果该实例由于任何原因（例如意外暂停）而无法访问，则剩余的“R / O”实例之一将自动接管其位置并成为新的“R / W”主要实例。</font>
										<font style="vertical-align: inherit;">在多主模式下，所有实例都标记为“R / W”，并且没有单个选定的主要实例。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">groupInformationSourceMember</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：用于获取有关集群的信息的内部连接，显示为URI类型字符串。</font>
										<font style="vertical-align: inherit;">通常最初用于创建集群的连接。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;"></font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								可以扩展操作</font>
							<font style="vertical-align: inherit;">
								的输出，
							</font>
							<font style="vertical-align: inherit;">以使您能够显示有关群集使用的基础组复制组的信息。</font>
							<font style="vertical-align: inherit;">要查看有关信息
							</font>
						</font><code class="literal">groupName</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，</font>
						</font><code class="literal">memberId</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，
							</font>
						</font><code class="literal">GRProtocolVersion</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">-由组，以及有关交易检查，提出的一些一般性的统计数据使用的通信协议，并通过实例拒绝，问题：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><em class="replaceable"><code>Cluster</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.STATUS（{扩展：真}）</font></font></pre>
					<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									小费
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									InnoDB集群管理自动使用的</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#innodb-cluster-group-replication-protocol"
							 title="InnoDB集群和组复制协议">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">组复制协议，</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									有关详细信息</font>
								<font style="vertical-align: inherit;">，请参阅
								</font><a class="xref" href="mysql-innodb-cluster-userguide.html#innodb-cluster-group-replication-protocol"
								 title="InnoDB集群和组复制协议">
									<font style="vertical-align: inherit;">InnoDB集群和组复制协议</font>
								</a>
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要查看有关恢复和常规事务I / O，应用程序工作线程统计信息和任何滞后的信息; </font>
							<font style="vertical-align: inherit;">应用程序协调器统计信息，如果启用了并行应用; </font>
							<font style="vertical-align: inherit;">错误，以及来自I / O和应用程序线程问题的其他信息
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><em class="replaceable"><code>Cluster</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.STATUS（{queryMembers：真}）</font></font></pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果</font>
						</font><code class="literal">queryMembers</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">设置为
							</font>
						</font><code class="literal">true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，则会打开与群集中每个实例的连接，以便可以查询其他特定于实例的统计信息。</font>
							<font style="vertical-align: inherit;">输出中包含的确切统计信息取决于实例的状态和配置以及服务器版本。</font>
							<font style="vertical-align: inherit;">此信息与</font>
						</font><a class="link" href="performance-schema.html#replication-group-member-stats-table" title="26.12.11.10 replication_group_member_stats表"><code
							 class="literal">replication_group_member_stats</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中显示的信息相匹配
							</font>
							<font style="vertical-align: inherit;">，请参阅匹配列的说明。</font>
						</font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">具有</font>
						</font><code class="literal">transactions</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">包含在输出中</font>
							<font style="vertical-align: inherit;">的
							</font>
							<font style="vertical-align: inherit;">对象的</font>
							<font style="vertical-align: inherit;">实例</font>
							<font style="vertical-align: inherit;">。</font>
						</font><code class="literal">RECOVERING</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">具有</font>
						</font><code class="literal">recovery</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">包含在输出中</font>
							<font style="vertical-align: inherit;">的
							</font>
							<font style="vertical-align: inherit;">对象的</font>
							<font style="vertical-align: inherit;">实例</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">在任何一种情况下，对象都可以包含以下内容：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">appliedCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_REMOTE_APPLIED</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">checkedCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_CHECKED</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">committedAllMembers</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">TRANSACTIONS_COMMITTED_ALL_MEMBERS</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">conflictsDetectedCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_CONFLICTS_DETECTED</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">inApplierQueueCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_REMOTE_IN_APPLIER_QUEUE</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">inQueueCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_IN_QUEUE</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastConflictFree</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_CONFLICT_FREE_TRANSACTION</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">proposedCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_LOCAL_PROPOSED</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">rollbackCount</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_TRANSACTIONS_LOCAL_ROLLBACK</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">connection</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分显示了该</font>
						</font><a class="link" href="performance-schema.html#replication-connection-status-table" title="26.12.11.2 replication_connection_status表"><code
							 class="literal">replication_connection_status</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中的信息</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">currentlyQueueing</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分包含有关当前排队的交易的信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION_START_QUEUE_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">QUEUEING_TRANSACTION</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastHeartbeatTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_HEARTBEAT_TIMESTAMP</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">lastQueued</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分包含有关最近排队的事务的信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">endTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_END_QUEUE_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">queueTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_END_QUEUE_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_START_QUEUE_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION_START_QUEUE_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_QUEUED_TRANSACTION</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">receivedHeartbeats</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">COUNT_RECEIVED_HEARTBEATS</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">receivedTransactionSet</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">RECEIVED_TRANSACTION_SET</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">threadId</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">THREAD_ID</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								使用多线程从属的实例有一个
							</font>
						</font><code class="literal">workers</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分，其中包含有关工作线程的信息，并匹配</font>
						</font><a class="link" href="performance-schema.html#replication-applier-status-by-worker-table" title="26.12.11.6 replication_applier_status_by_worker表"><code
							 class="literal">replication_applier_status_by_worker</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表中</font>
							<font style="vertical-align: inherit;">显示的信息
							</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">lastApplied</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分显示有关工作人员应用的上一个事务的以下信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">applyTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_END_APPLY_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_START_APPLY_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">endTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_END_APPLY_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION_START_APPLY_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_APPLIED_TRANSACTION</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">currentlyApplying</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分显示有关工作程序当前正在应用的事务的以下信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">APPLYING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">APPLYING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">APPLYING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：见
										</font>
									</font><code class="literal">APPLYING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减号</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">APPLYING_TRANSACTION_START_APPLY_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">APPLYING_TRANSACTION</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">lastProcessed</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分包含有关工作人员处理的最后一个事务的以下信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">bufferTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_END_BUFFER_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_START_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">endTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_END_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_END_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToEndTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_END_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION_START_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_PROCESSED_TRANSACTION</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果启用了并行应用程序工作程序，则会包含workers数组中的对象数</font>
						</font><code class="literal">transactions</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								或</font>
						</font><code class="literal">recovery</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">匹配已配置工作程序数以及其他协调程序对象。</font>
							<font style="vertical-align: inherit;">显示的信息与</font>
						</font><a class="link" href="performance-schema.html#replication-applier-status-by-coordinator-table" title="26.12.11.5 replication_applier_status_by_coordinator表"><code
							 class="literal">replication_applier_status_by_coordinator</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中的信息相匹配
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">该对象可以包含：
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">currentlyProcessing</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">部分包含有关工作人员正在处理的事务的以下信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">immediateCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION_IMMEDIATE_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">originalCommitToNowTime</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION_ORIGINAL_COMMIT_TIMESTAMP</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											减去</font>
									</font><code class="literal">NOW()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">startTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION_START_BUFFER_TIMESTAMP</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">transaction</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">PROCESSING_TRANSACTION</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<code class="literal">worker</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">如果在</font>
						</font><a class="link" href="performance-schema.html#replication-applier-status-by-worker-table" title="26.12.11.6 replication_applier_status_by_worker表"><code
							 class="literal">replication_applier_status_by_worker</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中检测到错误，则对象具有以下信息
							</font>
							<font style="vertical-align: inherit;">：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">lastErrno</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_NUMBER</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastError</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_MESSAGE</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastErrorTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_TIMESTAMP</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<code class="literal">connection</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">如果在</font>
						</font><a class="link" href="performance-schema.html#replication-connection-status-table" title="26.12.11.2 replication_connection_status表"><code
							 class="literal">replication_connection_status</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中检测到错误，则对象具有以下信息
							</font>
							<font style="vertical-align: inherit;">：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">lastErrno</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_NUMBER</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastError</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_MESSAGE</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastErrorTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_TIMESTAMP</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<code class="literal">coordinator</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">如果在</font>
						</font><a class="link" href="performance-schema.html#replication-applier-status-by-coordinator-table" title="26.12.11.5 replication_applier_status_by_coordinator表"><code
							 class="literal">replication_applier_status_by_coordinator</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								表</font>
							<font style="vertical-align: inherit;">中检测到错误，则对象具有以下信息
							</font>
							<font style="vertical-align: inherit;">：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">lastErrno</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_NUMBER</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastError</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_MESSAGE</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">lastErrorTimestamp</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：看
										</font>
									</font><code class="literal">LAST_ERROR_TIMESTAMP</code>
								</p>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="innodb-cluster-group-replication-protocol"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">InnoDB集群和组复制协议</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								从MySQL 8.0.16开始，Group Replication具有该组通信协议的概念，请参见
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-communication-protocol" title="18.4.2.4设置组的通信协议版本">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.4.2.4节“设置组的通信协议版本”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">用于背景信息。</font>
							<font style="vertical-align: inherit;">组复制通信协议版本通常必须显式管理，并设置为容纳您希望该组支持的最旧的MySQL服务器版本。</font>
							<font style="vertical-align: inherit;">但是，只要使用AdminAPI操作更改集群拓扑，InnoDB集群就会自动且透明地管理其成员的通信协议版本。</font>
							<font style="vertical-align: inherit;">群集始终使用当前属于群集或加入群集的所有实例都支持的最新通信协议版本。
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											在集群中添加，删除或重新加入实例，或者在集群上执行重新扫描或重新引导操作时，通信协议版本将自动设置为现在最早的MySQL服务器实例所支持的版本版。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											当您通过从群集中删除实例，升级它们并将它们添加回群集来执行滚动升级时，当旧的MySQL Server版本中的最后一个剩余实例从群集中删除之前，通信协议版本会自动升级。它的升级。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要查看群集中使用的通信协议版本，请使用
							</font>
							<font style="vertical-align: inherit;">启用</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">extended</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项的功能。</font>
							<font style="vertical-align: inherit;">如果</font>
						</font><code class="literal">GRProtocolVersion</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">群集具有仲裁且没有群集成员无法访问，</font>
							<font style="vertical-align: inherit;">则会在</font>
							<font style="vertical-align: inherit;">字段中</font>
							<font style="vertical-align: inherit;">返回通信协议版本
							</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="describe-structure-innodb-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">运用 </font>
									</font><code class="literal">cluster.describe()</code>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609405792"></a><a class="indexterm" name="idm140091609404304"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要获取有关InnoDB集群本身结构的信息，请使用以下
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.describe()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								函数：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.describe();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “clusterName”：“testCluster”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “defaultReplicaSet”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “名称”：“默认”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “拓扑”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-2：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-1：2306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-3：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-3：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								此函数的输出显示InnoDB集群的结构，包括其所有配置信息，等等。</font>
							<font style="vertical-align: inherit;">地址，标签和角色值与“ </font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#check-innodb-cluster-status" title="使用Cluster.status（）检查集群的状态">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">检查群集的状态”中
								</font>
							</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">描述的值相匹配</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="checking-version-on-instances"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">在实例上检查MySQL版本</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609395968"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								以下操作可以报告有关在实例上运行的MySQL Server版本的信息：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.describe()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								行为因</font>
						</font><em class="replaceable"><code>Cluster</code></em>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">对象会话</font>
							<font style="vertical-align: inherit;">的MySQL Server版本而异
							</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.status()</code>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果满足以下任一要求，
										</font>
									</font><code class="literal">version</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">则为对象的每个实例JSON对象返回字符串属性</font>
									</font><code class="literal">topology</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											：
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														该</font>
												</font><em class="replaceable"><code>Cluster</code></em>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">对象的当前会话是8.0.11或更高版本。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														该</font>
												</font><em class="replaceable"><code>Cluster</code></em>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">对象的当前会话早于8.0.11版本和
													</font>
												</font><code class="literal">queryMembers</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">选项启用。
													</font>
												</font>
											</p>
										</li>
									</ul>
								</div>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											例如，在运行8.0.16版的实例上：
										</font>
									</font>
								</p>
								<pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“拓扑”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “ic-1：3306”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “地址”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “模式”：“R / W”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “readReplicas”：{}，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “角色”：“HA”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “状态”：“在线”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “版本”：“8.0.16”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											例如，在运行版本5.7.24的实例上：
										</font>
									</font>
								</p>
								<pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“拓扑”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “ic-1：3306”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “地址”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “模式”：“R / W”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “readReplicas”：{}，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “角色”：“HA”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “状态”：“在线”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “版本”：“5.7.24”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.describe()</code>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果</font>
									</font><em class="replaceable"><code>Cluster</code></em>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">对象的当前会话是8.0.11版本或更高版本，一个
										</font>
									</font><code class="literal">version</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">字符串属性，返回的是每个实例JSON对象</font>
									</font><code class="literal">topology</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											对象
										</font>
									</font>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											例如，在运行8.0.16版的实例上：
										</font>
									</font>
								</p>
								<pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“拓扑”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “地址”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “label”：“ic-1：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “角色”：“HA”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “版本”：“8.0.16”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
]</font></font><font></font>
</pre>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果</font>
									</font><em class="replaceable"><code>Cluster</code></em>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">对象的当前会话是8.0.11或更高版本，并且
										</font>
									</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											操作检测到不属于该集群的实例，</font>
									</font><code class="literal">version</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">则会为该对象的每个实例JSON对象返回</font>
										<font style="vertical-align: inherit;">一个</font>
										<font style="vertical-align: inherit;">字符串属性
										</font>
									</font><code class="literal">newlyDiscoveredInstance</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											例如，在运行8.0.16版的实例上：
										</font>
									</font>
								</p>
								<pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“新发现的实例”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “主持人”：“ic-4：3306”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “member_id”：“82a67a06-2ba3-11e9-8cfc-3c6aa7197deb”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “name”：null，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “版本”：“8.0.16”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
]	</font></font><font></font>
</pre>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="super-read-only-on-instance"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">超级只读和实例</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609362752"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								每当组复制停止时，该
							</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">变量将设置</font>
						</font><code class="literal">ON</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">为确保不对该实例进行写入。</font>
							<font style="vertical-align: inherit;">当您尝试将此类实例与以下AdminAPI命令一起使用时，您可以选择</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在实例上</font>
							<font style="vertical-align: inherit;">进行设置</font>
							<font style="vertical-align: inherit;">：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">dba.configureInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.configureLocalInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.createCluster()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.rebootClusterFromCompleteOutage()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.dropMetadataSchema()</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当AdminAPI遇到具有</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">交互模式</font>
							<font style="vertical-align: inherit;">的实例时，
							</font>
							<font style="vertical-align: inherit;">您可以选择进行设置
							</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>var myCluster = dba.createCluster('testCluster')</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将在实例'ic @ ic-1：3306'上创建一个新的InnoDB集群。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'ic @ ic-1：3306'的MySQL实例目前有super_read_only </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
系统变量设置为保护它免受应用程序的无意更新。 </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您必须先取消设置才能对此实例执行任何更改。 </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有关详细信息，请参阅：https：//dev.mysql.com/doc/refman/en/server-system-variables.html#sysvar_super_read_only。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意：有'ic @ ic-1：3306'的开放会话。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可能希望终止这些会话以防止它们执行意外更新： </font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1个开放会话'ic @ ic-1：3306'。 </font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你想禁用super_read_only并继续吗？</font><font style="vertical-align: inherit;">[Y | N]：</font></font><font></font>
<font></font>
	</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								显示实例的当前活动会话数。</font>
							<font style="vertical-align: inherit;">您必须确保没有应用程序可能无意中写入该实例。</font>
							<font style="vertical-align: inherit;">通过回答</font>
						</font><code class="literal">y</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">您确认AdminAPI可以写入实例。</font>
							<font style="vertical-align: inherit;">如果列出的实例有多个打开的会话，请在允许AdminAPI设置之前谨慎操作
							</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要强制</font>
						</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在脚本中</font>
							<font style="vertical-align: inherit;">设置函数，请将
							</font>
						</font><code class="literal">clearReadOnly</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项设置为
							</font>
						</font><code class="literal">true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">例如
							</font>
						</font><code class="literal">dba.configureInstance(<em class="replaceable"><code>instance</code></em>,
							{clearReadOnly: true}).</code>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="configuring-automatic-rejoin-of-instances"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置实例的自动重新加入</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609335456"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								运行MySQL 8.0.16及更高版本的实例支持组复制自动重新加入功能，这使您可以将实例配置为在被驱逐后自动重新加入群集。</font>
							<font style="vertical-align: inherit;">有关</font>
							<font style="vertical-align: inherit;">背景信息</font>
						</font><a class="xref" href="group-replication.html#group-replication-responses-failure" title="18.6.6响应故障检测和网络分区">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">请参见
							</font><a class="xref" href="group-replication.html#group-replication-responses-failure" title="18.6.6响应故障检测和网络分区">
								<font style="vertical-align: inherit;">第18.6.6节“对故障检测和网络分区的响应”</font>
							</a>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">AdminAPI提供了一个
							</font>
						</font><code class="literal">autoRejoinTries</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项，用于配置在驱逐后重新加入群集的尝试实例数。</font>
							<font style="vertical-align: inherit;">默认情况下，实例不会自动重新加入群集。</font>
							<font style="vertical-align: inherit;">您可以</font>
						</font><code class="literal">autoRejoinTries</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">使用以下命令在集群级别或单个实例上</font>
							<font style="vertical-align: inherit;">配置该
							</font>
							<font style="vertical-align: inherit;">选项：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">dba.createCluster()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.addInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.setOption()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.setInstanceOption()</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">autoRejoinTries</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项接受介于0和2016之间的正整数值，默认值为0，这意味着实例不会尝试自动重新加入。</font>
							<font style="vertical-align: inherit;">当您使用自动重新加入功能时，您的群集更容忍故障，尤其是诸如不可靠网络之类的临时故障。</font>
							<font style="vertical-align: inherit;">但是，如果丢失了仲裁，则不应期望成员自动重新加入群集，因为大多数都需要重新加入实例。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								运行MySQL 8.0.12及更高版本的实例具有</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_exit_state_action"><code class="literal">group_replication_exit_state_action</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								变量，您可以使用AdminAPI </font>
						</font><code class="literal">exitStateAction</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">配置</font>
							<font style="vertical-align: inherit;">该
							</font>
							<font style="vertical-align: inherit;">变量
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">这可以控制在意外离开集群时实例执行的操作。</font>
							<font style="vertical-align: inherit;">默认情况下，该</font>
						</font><code class="literal">exitStateAction</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项
							</font>
						</font><code class="literal">READ_ONLY,</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">意味着离开群集的实例意外地变为只读。</font>
							<font style="vertical-align: inherit;">如果
							</font>
						</font><code class="literal">exiStateAction</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">是
							</font>
						</font><code class="literal">ABORT_SERVER</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在意外离开集群的情况下，该实例将关闭MySQL，并且必须在它重新加入集群之前再次启动它。</font>
							<font style="vertical-align: inherit;">请注意，当您使用自动重新加入功能时，由...配置的操作</font>
						</font><code class="literal">exitStateAction</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项仅在所有重新加入群集的尝试失败时发生。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可能有可能连接到实例并尝试使用AdminAPI进行配置，但此时实例可能正在重新加入群集。</font>
							<font style="vertical-align: inherit;">只要您使用以下任何操作，就会发生这种情况：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">Cluster.status()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">dba.getCluster()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.rejoinInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.addInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.removeInstance()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.rescan()</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">Cluster.checkInstanceState()</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当实例自动重新加入群集时，这些操作可能会提供额外信息。</font>
							<font style="vertical-align: inherit;">此外，在使用时
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，如果目标实例自动重新加入群集，则操作将中止，除非您传入
							</font>
						</font><code class="literal">force:true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="manage-sandbox-instances"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">管理沙箱实例</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609300560"></a><a class="indexterm" name="idm140091609299056"></a><a class="indexterm"
					 name="idm140091609297552"></a><a class="indexterm" name="idm140091609296048"></a><a class="indexterm" name="idm140091609294544"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								沙箱实例运行后，可以使用以下方法随时更改其状态：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											停止使用沙盒实例
										</font>
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">这样可以优雅地停止实例，与之不同
										</font>
										<font style="vertical-align: inherit;">。
										</font>
									</font><code class="literal">dba.stopSandboxInstance(<em class="replaceable"><code>instance</code></em>)</code>
									<font style="vertical-align: inherit;"></font><code class="literal">dba.killSandboxInstance(<em class="replaceable"><code>instance</code></em>)</code>
									<font style="vertical-align: inherit;"></font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											要启动沙箱实例使用
										</font>
										<font style="vertical-align: inherit;">。
										</font>
									</font><code class="literal">dba.startSandboxInstance(<em class="replaceable"><code>instance</code></em>)</code>
									<font style="vertical-align: inherit;"></font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											要杀死沙箱实例使用
										</font>
									</font><code class="literal">dba.killSandboxInstance(<em class="replaceable"><code>instance</code></em>)</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">这会在没有正常停止的情况下停止实例，并且在模拟意外停止时非常有用。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											要删除沙箱实例，请使用
										</font>
										<font style="vertical-align: inherit;">。</font>
										<font style="vertical-align: inherit;">这会从文件系统中完全删除沙箱实例。
										</font>
									</font><code class="literal">dba.deleteSandboxInstance(<em class="replaceable"><code>instance</code></em>)</code>
									<font style="vertical-align: inherit;"></font>
								</p>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="remove-instances-from-innodb-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从InnoDB集群中删除实例</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609281424"></a><a class="indexterm" name="idm140091609279968"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果您愿意，可以随时从群集中删除实例。</font>
							<font style="vertical-align: inherit;">这可以使用该</font>
							<font style="vertical-align: inherit;">
								方法</font>
							<font style="vertical-align: inherit;">完成，
							</font>
							<font style="vertical-align: inherit;">如下例所示：
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance(<em class="replaceable"><code>instance</code></em>)</code>
						<font style="vertical-align: inherit;"></font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.removeInstance('root@localhost:3310')</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该实例将从InnoDB集群中删除。</font><font style="vertical-align: inherit;">取决于实例</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论是否为Seed，元数据会话可能会变为无效。</font><font style="vertical-align: inherit;">如果是的话，请</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
启动到Metadata Storage R / W实例的新会话。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
试图离开组复制组...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
已成功从群集中删除实例“localhost：3310”。</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以选择传递</font>
						</font><code class="literal">interactive</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项以控制是否提示您确认从群集中删除实例。</font>
							<font style="vertical-align: inherit;">在交互模式下，系统会提示您继续删除实例（如果无法访问）。</font>
							<font style="vertical-align: inherit;">该
							</font>
						</font><code class="literal"><em class="replaceable"><code>cluster</code></em>.removeInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作确保从所有集群成员</font>
						</font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和实例本身</font>
							<font style="vertical-align: inherit;">的元数据中删除</font>
							<font style="vertical-align: inherit;">实例。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当被删除的实例具有仍然需要应用的事务时，AdminAPI会等待MySQL Shell </font>
						</font><code class="literal">dba.gtidWaitTimeout</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项为要应用的事务（GTID）</font>
							<font style="vertical-align: inherit;">配置的秒数
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">MySQL Shell
							</font>
						</font><code class="literal">dba.gtidWaitTimeout</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项的默认值为60秒，</font>
							<font style="vertical-align: inherit;">有关更改默认值的信息</font>
							<font style="vertical-align: inherit;">，请参阅
							</font>
						</font><a class="ulink" href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-configuring-options.html"
						 target="_top">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">配置MySQL Shell选项</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">如果</font>
						</font><code class="literal">dba.gtidWaitTimeout</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在等待应用事务并且</font>
						</font><code class="literal">force</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
						</font><code class="literal">false</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">（或未定义）</font>
							<font style="vertical-align: inherit;">时达到</font>
							<font style="vertical-align: inherit;">定义的超时值，</font>
							<font style="vertical-align: inherit;">则会
							</font>
							<font style="vertical-align: inherit;">发出错误并中止删除操作。</font>
							<font style="vertical-align: inherit;">如果定义的超时值
							</font>
						</font><code class="literal">dba.gtidWaitTimeout</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">在等待应用事务并且将该</font>
						</font><code class="literal">force</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项设置为</font>
						</font><code class="literal">true</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">然后操作继续而没有错误时到达，并从集群中删除该实例。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									该</font>
							</font><code class="literal">force</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">选项仅应
								</font>
								<font style="vertical-align: inherit;">
									在您要忽略任何错误时使用，例如未处理的事务或实例
								</font>
								<font style="vertical-align: inherit;">，并且不打算在集群中重用该实例。</font>
								<font style="vertical-align: inherit;">从群集中删除实例时忽略错误可能导致实例与群集不同步，从而阻止其稍后重新加入群集。</font>
								<font style="vertical-align: inherit;">当您计划不再使用群集中的实例时，</font>
								<font style="vertical-align: inherit;">仅使用该
								</font>
								<font style="vertical-align: inherit;">选项，在所有其他情况下，您应始终尝试恢复实例，并仅在可用且健康时将其删除，换句话说，使用状态
								</font>
								<font style="vertical-align: inherit;">。
								</font>
							</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance(<em class="replaceable"><code>instance</code></em>)</code>
							<font style="vertical-align: inherit;"></font><code class="literal">UNREACHABLE</code>
							<font style="vertical-align: inherit;"></font><code class="literal">force</code>
							<font style="vertical-align: inherit;"></font><code class="literal">ONLINE</code>
							<font style="vertical-align: inherit;"></font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="customize-your-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">自定义InnoDB集群</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609256416"></a><a class="indexterm" name="idm140091609254960"></a><a class="indexterm"
					 name="idm140091609253472"></a><a class="indexterm" name="idm140091609251968"></a><a class="indexterm" name="idm140091609250480"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								创建集群并向其添加实例时，AdminAPI会自动配置组名，本地地址和种子实例等值。</font>
							<font style="vertical-align: inherit;">建议大多数部署使用这些默认值，但高级用户可以通过将以下选项传递给</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
							<font style="vertical-align: inherit;">来覆盖默认值</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要自定义InnoDB集群创建的复制组的名称，请将该</font>
						</font><code class="literal">groupName</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递</font>
							<font style="vertical-align: inherit;">给该</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令。</font>
							<font style="vertical-align: inherit;">这将设置
							</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_group_name"><code class="literal">group_replication_group_name</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								系统变量。</font>
							<font style="vertical-align: inherit;">该名称必须是有效的UUID。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要自定义实例为来自其他实例的连接提供的地址，请将</font>
						</font><code class="literal">localAddress</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递
							</font>
							<font style="vertical-align: inherit;">给
							</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">cluster.addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令。</font>
							<font style="vertical-align: inherit;">以格式指定地址
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">这将</font>
							<font style="vertical-align: inherit;">
								在实例上</font>
							<font style="vertical-align: inherit;">设置
							</font>
							<font style="vertical-align: inherit;">系统变量。</font>
							<font style="vertical-align: inherit;">该地址必须可供集群中的所有实例访问，并且必须仅为内部集群通信保留。</font>
							<font style="vertical-align: inherit;">换句话说，不要使用此地址与实例进行通信。
							</font>
						</font><code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
						<font style="vertical-align: inherit;"></font><a class="link" href="group-replication.html#sysvar_group_replication_local_address"><code
							 class="literal">group_replication_local_address</code></a>
						<font style="vertical-align: inherit;"></font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要在实例加入群集时自定义用作种子的实例，请将</font>
						</font><code class="literal">groupSeeds</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递</font>
							<font style="vertical-align: inherit;">给</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">cluster.addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令。</font>
							<font style="vertical-align: inherit;">当新实例加入群集并用于向新实例提供数据时，将联系种子实例。</font>
							<font style="vertical-align: inherit;">地址被指定为以逗号分隔的列表，例如
							</font>
						</font><code class="literal">host1:port1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，</font>
						</font><code class="literal">host2:port2</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">这会配置
							</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_group_seeds"><code class="literal">group_replication_group_seeds</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								系统变量。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								有关更多信息，请参阅这些AdminAPI选项配置的系统变量的文档。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="rejoin-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">重新加入群集</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609230320"></a><a class="indexterm" name="idm140091609228832"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果实例离开集群，例如因为它丢失了连接，并且由于某种原因它无法自动重新加入集群，则可能需要在稍后阶段将其重新加入集群。</font>
							<font style="vertical-align: inherit;">将实例重新加入群集问题
							</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rejoinInstance(<em class="replaceable"><code>instance</code></em>)</code>
						<font style="vertical-align: inherit;"></font>
					</p>
					<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									小费
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果实例有，
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">有关</font>
								<font style="vertical-align: inherit;">详细信息，</font>
								<font style="vertical-align: inherit;">请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">超级只读和实例</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果实例尚未保持配置（请参阅
							</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-persisting-settings" title="持久设置">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">“保持设置”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">），则重新启动后实例不会自动重新加入群集。</font>
							<font style="vertical-align: inherit;">解决方案是发出
							</font>
						</font><code class="literal">cluster.rejoinInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">以便将实例再次添加到集群并确保更改持久化。</font>
							<font style="vertical-align: inherit;">将InnoDB集群配置持久保存到实例的选项文件后，它会自动重新加入集群。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果要重新加入以某种方式更改的实例，则可能必须修改实例以使重新加入过程正常工作。</font>
							<font style="vertical-align: inherit;">例如，在还原MySQL Enterprise Backup备份时，会进行</font>
						</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								更改。</font>
							<font style="vertical-align: inherit;">尝试重新加入此类实例失败，因为InnoDB集群实例由</font>
						</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">变量</font>
							<font style="vertical-align: inherit;">标识
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">在这种情况下，</font>
						</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">必须从InnoDB集群元数据中删除</font>
							<font style="vertical-align: inherit;">有关实例旧的信息
							</font>
							<font style="vertical-align: inherit;">，然后
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								必须执行必须使用它的新实例将实例添加到元数据中</font>
						</font><a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cluster.removeInstance（“root @ instanceWithOldUUID：3306”，{force：true}）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cluster.rescan（）</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在这种情况下，您必须将</font>
						</font><code class="literal">force</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递</font>
							<font style="vertical-align: inherit;">给
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.removeInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								方法，因为从集群的角度来看实例是无法访问的，我们希望无论如何都要从InnoDB集群元数据中删除它。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="restore-cluster-from-quorum-loss"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从仲裁丢失中恢复群集</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609207232"></a><a class="indexterm" name="idm140091609205728"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果一个或多个实例失败，则群集可能会失去其仲裁，即能够在新主节点中投票。</font>
							<font style="vertical-align: inherit;">如果存在足够实例的故障，组成群集的大多数实例不再对组复制操作进行投票，则会发生这种情况。</font>
							<font style="vertical-align: inherit;">当群集丢失仲裁时，您无法再处理与群集的写入事务，也无法更改群集的拓扑，例如通过添加，重新加入或删除实例。</font>
							<font style="vertical-align: inherit;">但是，如果您有一个包含InnoDB集群元数据的在线实例，则可以使用仲裁还原集群。</font>
							<font style="vertical-align: inherit;">这假设您可以连接到包含InnoDB集群元数据的实例，
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									此操作具有潜在的危险性，因为如果使用不当会导致裂脑情况，应该被视为最后的手段。</font>
								<font style="vertical-align: inherit;">确保该组中没有仍在网络中运行的分区，但无法从您的位置访问。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								连接到包含群集元数据的实例，然后使用该
							</font>
							<font style="vertical-align: inherit;">
								操作，该操作将根据元数据恢复群集
							</font>
							<font style="vertical-align: inherit;">，然后</font>
							<font style="vertical-align: inherit;">将从给定实例定义的角度来看的所有实例添加到已还原的群集。
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.forceQuorumUsingPartitionOf(<em
							 class="replaceable"><code>instance</code></em>)</code>
						<font style="vertical-align: inherit;"></font><em class="replaceable"><code>instance</code></em>
						<font style="vertical-align: inherit;"></font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;"></font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.forceQuorumUsingPartitionOf("ic@ic-1:3306")</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  通过使用由[ic @ ic-1：3306]组成的分区，从仲裁丢失中恢复复制集“默认”</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  请提供“ic @ ic-1：3306”的密码：******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  恢复InnoDB集群......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  使用实例'ic @ ic-1：3306'中的分区成功恢复了InnoDB集群。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  警告：为避免裂脑情况，请确保复制的所有其他成员</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  被删除或连接回已恢复的组。</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果实例未自动添加到群集，例如，如果其设置未保留，请使用
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rejoinInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								手动将实例添加回群集。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								还原的群集可能不会也不必包含构成群集的所有原始实例。</font>
							<font style="vertical-align: inherit;">例如，如果原始群集由以下五个实例组成：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">ic-1</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-2</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-3</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-4</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-5</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								和群集经历脑分裂情况下，与
							</font>
						</font><code class="literal">ic-1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，</font>
						</font><code class="literal">ic-2</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，和
							</font>
						</font><code class="literal">ic-3</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">形成而一个分区
							</font>
						</font><code class="literal">ic-4</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和</font>
						</font><code class="literal">ic-5</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">形成另一分区。</font>
							<font style="vertical-align: inherit;">如果连接到</font>
						</font><code class="literal">ic-1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">并
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.forceQuorumUsingPartitionOf('ic@ic-1:3306')</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								恢复群集，则生成的群集将包含以下三个实例：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">ic-1</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-2</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">ic-3</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								因为</font>
						</font><code class="literal">ic-1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">看到</font>
						</font><code class="literal">ic-2</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">ic-3</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">作为</font>
						</font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，不看</font>
						</font><code class="literal">ic-4</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和</font>
						</font><code class="literal">ic-5</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="reboot-outage"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">从主要中断重新启动群集</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609168880"></a><a class="indexterm" name="idm140091609167408"></a><a class="indexterm"
					 name="idm140091609165904"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">


								如果您的群集遭受完全中断，您可以确保使用正确的重新配置
							</font>
						</font><code class="literal">dba.rebootClusterFromCompleteOutage()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">此操作采用MySQL Shell当前连接的实例并使用其元数据来恢复群集。</font>
							<font style="vertical-align: inherit;">如果群集的实例已完全停止，则必须启动实例，然后才能启动群集。</font>
							<font style="vertical-align: inherit;">例如，如果已重新启动运行沙箱群集的计算机，并且实例位于端口3310,3320和3330，则发出：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-js&gt; </font></font><strong class="userinput"><code>dba.startSandboxInstance(3310)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql-js&gt; </font></font><strong class="userinput"><code>dba.startSandboxInstance(3320)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql-js&gt;</font></font><strong class="userinput"><code>dba.startSandboxInstance(3330)</code></strong>
    </pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								这可确保沙盒实例正在运行。</font>
							<font style="vertical-align: inherit;">在生产部署的情况下，您必须在MySQL Shell之外启动实例。</font>
							<font style="vertical-align: inherit;">实例启动后，您需要连接到具有GTID超集的实例，这意味着在中断之前应用了最多事务的实例。</font>
							<font style="vertical-align: inherit;">如果您不确定哪个实例包含GTID超集，请连接到任何实例并按照其中的交互消息进行操作</font>
						</font><code class="literal">dba.rebootClusterFromCompleteOutage()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，该</font>
							<font style="vertical-align: inherit;">消息
							</font>
							<font style="vertical-align: inherit;">检测您连接的实例是否包含GTID超集。</font>
							<font style="vertical-align: inherit;">通过发出以下命令重启群集：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>var cluster = dba.rebootClusterFromCompleteOutage();</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								然后，</font>
						</font><code class="literal">dba.rebootClusterFromCompleteOutage()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作遵循以下步骤以确保正确地重新配置群集：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											检查在MySQL Shell当前连接的实例上找到的InnoDB集群元数据，以查看它是否包含GTID超集，换句话说，是集群应用的事务。</font>
										<font style="vertical-align: inherit;">如果当前连接的实例不包含GTID超集，则操作将中止该信息。</font>
										<font style="vertical-align: inherit;">有关更多信息，请参阅后续段落。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果实例包含GTID超集，则会根据实例的元数据恢复群集。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											假设您在交互模式下运行MySQL Shell，则会运行一个向导，检查当前可以访问哪个群集实例，并询问您是否要将任何已发现的实例重新加入重新引导的群集。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											同样，在交互模式下，向导还会检测当前无法访问的实例，并询问您是否要从重新引导的群集中删除此类实例。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果您未使用MySQL Shell的交互模式，则可以使用</font>
						</font><code class="literal">rejoinInstances</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">removeInstances</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项手动配置在重新引导群集期间应加入或删除的实例。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果遇到错误，例如</font>
						</font><span class="errortext">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">活动会话实例与群集元数据的ONLINE实例相比不是最新的。</font>
							</font>
						</span>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">那么您连接的实例没有集群应用的事务的GTID超集。</font>
							<font style="vertical-align: inherit;">在这种情况下，将MySQL Shell连接到错误消息中建议的实例并</font>
						</font><code class="literal">dba.rebootClusterFromCompleteOutage()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								从该实例</font>
							<font style="vertical-align: inherit;">发出</font>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									小费
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									如果实例有，
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">那么您可能需要确认AdminAPI可以设置
								</font>
							</font><a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">有关</font>
								<font style="vertical-align: inherit;">详细信息，</font>
								<font style="vertical-align: inherit;">请参阅
								</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#super-read-only-on-instance" title="超级只读和实例">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">超级只读和实例</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									要手动检测哪个实例具有GTID超集而不是使用交互式向导，请检查</font>
							</font><a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">每个实例上</font>
								<font style="vertical-align: inherit;">的
								</font>
								<font style="vertical-align: inherit;">变量。</font>
								<font style="vertical-align: inherit;">例如问题：
								</font>
							</font>
						</p>
						<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-SQL&gt; </font></font><strong class="userinput"><code>SHOW VARIABLES LIKE 'gtid_executed';</code></strong></pre>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									应用了最大</font>
							</font><a class="ulink" href="replication-gtids-concepts-gtid-sets" target="_top">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">GTID</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">事务集</font>
								<font style="vertical-align: inherit;">的实例
								</font>
								<font style="vertical-align: inherit;">包含GTID超集。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果此过程失败，并且群集元数据已严重损坏，则可能需要删除元数据并从头开始再次创建群集。</font>
							<font style="vertical-align: inherit;">您可以使用删除群集元数据</font>
						</font><code class="literal">dba.dropMetadataSchema()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									警告
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;"></font><code class="literal">dba.dropMetadataSchema()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">当无法恢复群集时，</font>
								<font style="vertical-align: inherit;">
									该</font>
								<font style="vertical-align: inherit;">方法应仅用作最后的手段。</font>
								<font style="vertical-align: inherit;">它无法撤消。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="rescan-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">重新扫描群集</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609131648"></a><a class="indexterm" name="idm140091609130160"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								如果对AdminAPI命令之外的集群进行配置更改（例如，通过手动更改实例的配置以解决配置问题或在实例丢失后），则需要更新InnoDB集群元数据，以使其与当前的配置相匹配实例。</font>
							<font style="vertical-align: inherit;">在这些情况下，请使用该
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作，该操作使您可以手动或使用交互式向导更新InnoDB群集元数据。</font>
							<font style="vertical-align: inherit;">该
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作可以检测未在元数据中注册的新活动实例并添加它们，或者仍然在元数据中注册的过时实例（不再活动），并将其删除。</font>
							<font style="vertical-align: inherit;">您可以根据命令找到的实例自动更新元数据，也可以指定实例地址列表以添加元数据或从元数据中删除。</font>
							<font style="vertical-align: inherit;">您还可以更新存储在元数据中的拓扑模式，例如在AdminAPI之外从单主模式更改为多主模式之后。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该命令的语法是
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.rescan([options])</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">该</font>
						</font><code class="literal">options</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">词典支持以下内容：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">interactive</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：boolean值，用于在命令执行中禁用或启用向导。</font>
										<font style="vertical-align: inherit;">控制是否提供提示和确认。</font>
										<font style="vertical-align: inherit;">默认值等于MySQL Shell向导模式，由</font>
									</font><code class="literal">shell.options.useWizards</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">addInstances</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：list，其中包含要添加到元数据的新活动实例的连接数据，或者
										</font>
									</font><span class="quote">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">“ </font>
										</font><span class="quote">
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">auto</font>
											</font>
										</span>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> ”</font>
										</font>
									</span>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">以自动将缺少的实例添加到元数据中。</font>
										<font style="vertical-align: inherit;">值</font>
									</font><span class="quote">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">“ </font>
										</font><span class="quote">
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">auto</font>
											</font>
										</span>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> ”</font>
										</font>
									</span>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">不区分大小写。
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														列表中指定的实例将添加到元数据中，而不会提示进行确认
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														在交互模式下，系统会提示您确认添加未包含在</font>
												</font><code class="literal">addInstances</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">选项中
													</font>
													<font style="vertical-align: inherit;">的新发现的实例</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														在非交互模式下，</font>
												</font><code class="literal">addInstances</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														输出中会报告</font>
													<font style="vertical-align: inherit;">未包含在</font>
													<font style="vertical-align: inherit;">选项中的</font>
													<font style="vertical-align: inherit;">新发现的实例</font>
													<font style="vertical-align: inherit;">，但不会提示您添加它们
													</font>
												</font>
											</p>
										</li>
									</ul>
								</div>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">removeInstances</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：list，包含要从元数据中删除的过时实例的连接数据，或</font>
									</font><span class="quote">
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;">“ </font>
										</font><span class="quote">
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">auto</font>
											</font>
										</span>
										<font style="vertical-align: inherit;">
											<font style="vertical-align: inherit;"> ”</font>
										</font>
									</span>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">以自动从元数据中删除过时的实例。
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														列表中指定的实例将从元数据中删除，而不会提示进行确认
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														在交互模式下，系统会提示您确认删除未包含在</font>
												</font><code class="literal">removeInstances</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">选项中
													</font>
													<font style="vertical-align: inherit;">的过时实例</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														在非交互模式下，</font>
												</font><code class="literal">removeInstances</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														输出中会报告</font>
													<font style="vertical-align: inherit;">未包含在</font>
													<font style="vertical-align: inherit;">选项中的</font>
													<font style="vertical-align: inherit;">过时实例，</font>
													<font style="vertical-align: inherit;">但不会提示您删除它们
													</font>
												</font>
											</p>
										</li>
									</ul>
								</div>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">updateTopologyMode</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">：boolean值，用于指示元数据中的拓扑模式（单主或多主）是否应更新（true）或不更新（false）以匹配群集使用的拓扑模式。</font>
										<font style="vertical-align: inherit;">默认情况下，元数据不会更新（false）。
										</font>
									</font>
								</p>
								<div class="itemizedlist">
									<ul class="itemizedlist" style="list-style-type: circle; ">
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														如果值为，</font>
												</font><code class="literal">true</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">则将InnoDB集群元数据与Group Replication使用的当前模式进行比较，并在必要时更新元数据。</font>
													<font style="vertical-align: inherit;">在AdminAPI之外更改群集的拓扑模式后，使用此选项更新元数据。
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														如果值为，</font>
												</font><code class="literal">false</code>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">那么即使群集的拓扑模式与集群的组复制组使用的拓扑不同，也不会更新有关集群拓扑模式的InnoDB集群元数据
													</font>
												</font>
											</p>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														如果未指定该选项且元数据中的拓扑模式与群集的“组复制”组使用的拓扑不同，则：
													</font>
												</font>
											</p>
											<div class="itemizedlist">
												<ul class="itemizedlist" style="list-style-type: square; ">
													<li class="listitem">
														<p>
															<font style="vertical-align: inherit;">
																<font style="vertical-align: inherit;">
																	在交互模式下，系统会提示您确认元数据中拓扑模式的更新
																</font>
															</font>
														</p>
													</li>
													<li class="listitem">
														<p>
															<font style="vertical-align: inherit;">
																<font style="vertical-align: inherit;">
																	在非交互模式下，如果群集的组复制组使用的拓扑与InnoDB群集元数据之间存在差异，则会报告该拓扑，并且不会对元数据进行任何更改
																</font>
															</font>
														</p>
													</li>
												</ul>
											</div>
										</li>
										<li class="listitem">
											<p>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">
														更新元数据拓扑模式以匹配组复制模式时，将按</font>
												</font><a class="xref" href="mysql-innodb-cluster-userguide.html#mysql-innodb-cluster-auto-increment" title="InnoDB集群和自动增量">
													<font style="vertical-align: inherit;">
														<font style="vertical-align: inherit;">InnoDB集群和自动增量中</font>
													</font>
												</a>
												<font style="vertical-align: inherit;">
													<font style="vertical-align: inherit;">所述更新所有实例上的自动增量设置
													</font>
													<font style="vertical-align: inherit;">。
													</font>
												</font>
											</p>
										</li>
									</ul>
								</div>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="check-instance-state"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">检查实例状态</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609093792"></a><a class="indexterm" name="idm140091609092336"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">cluster.checkInstanceState()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">函数可用于验证实例上的现有数据不会阻止它加入集群。</font>
							<font style="vertical-align: inherit;">此过程通过验证实例的全局事务标识符（GTID）状态与集群已处理的GTID进行比较来工作。</font>
							<font style="vertical-align: inherit;">有关</font>
						</font><a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID格式和存储">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">GTID的</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">更多信息，请参见
							</font><a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID格式和存储">
								<font style="vertical-align: inherit;">第17.1.3.1节“GTID格式和存储”</font>
							</a>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">通过此检查，您可以确定是否可以将已处理事务的实例添加到集群。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								以下演示了在运行的MySQL Shell中发布它：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.checkInstanceState('ic@ic-4:3306')</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">


								此函数的输出可以是以下之一：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											OK new：实例没有执行任何GTID事务，因此它不能与集群执行的GTID冲突
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											OK可恢复：实例已执行GTID，这些GTID与集群种子实例的已执行GTID不冲突
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											错误分歧：实例已执行GTID，该GTID与集群种子实例的已执行GTID不同
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											错误lost_transactions：实例执行的GTID比集群种子实例的执行GTID更多
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								可以将具有“正常”状态的实例添加到群集，因为实例上的任何数据都与群集一致。</font>
							<font style="vertical-align: inherit;">换句话说，正在检查的实例没有执行任何与集群执行的GTID冲突的事务，并且可以恢复到与其余集群实例相同的状态。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="dissolve-innodb-cluster"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">解散InnoDB集群</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609079008"></a><a class="indexterm" name="idm140091609077552"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								要解散InnoDB集群，您需要连接到读写实例，例如单主集群中的主实例，然后使用该
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								命令。</font>
							<font style="vertical-align: inherit;">这将删除与群集关联的所有元数据和配置，并禁用实例上的组复制。</font>
							<font style="vertical-align: inherit;">不会删除在实例之间复制的任何数据。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									无法撤消群集的解散。</font>
								<font style="vertical-align: inherit;">要再次创建它使用</font>
							</font><code class="literal">dba.createCluster()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作只能配置</font>
						</font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">可访问的</font>
							<font style="vertical-align: inherit;">实例
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">如果您发布的成员无法访问群集的成员
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								命令你必须决定溶解操作应该如何进行。</font>
							<font style="vertical-align: inherit;">如果您有可能想要重新加入群集中标识为丢失的任何实例，强烈建议取消溶解操作并首先将缺失的实例重新联机，然后再继续执行溶解操作。</font>
							<font style="vertical-align: inherit;">这可以确保所有实例都可以正确更新其元数据，并且不会出现裂脑情况。</font>
							<font style="vertical-align: inherit;">但是，如果群集中无法到达的实例已永久离开群集，则除了强制执行溶解操作之外别无选择，这意味着将忽略缺少的实例，并且只有在线实例会受到操作的影响。
							</font>
						</font>
					</p>
					<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									警告
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									强制溶解操作忽略群集实例可能导致在溶解操作期间无法达到的实例继续操作，从而产生裂脑情况的风险。</font>
								<font style="vertical-align: inherit;">如果您确定实例无法再次联机，则只强制解析操作以忽略丢失的实例。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在交互模式下，如果在解散操作期间无法访问群集的成员，则会显示交互式提示，例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code><em class="replaceable"><code>Cluster</code></em>.dissolve()</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
群集仍具有以下已注册的ReplicaSet：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “clusterName”：“testCluster”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “defaultReplicaSet”：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “名称”：“默认”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “拓扑”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-1：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-1：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-2：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-2：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “地址”：“ic-3：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “label”：“ic-3：3306”， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                “角色”：“HA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告：您即将解散整个群集并失去高位</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它提供的可用性功能。</font><font style="vertical-align: inherit;">此操作无法恢复。</font><font style="vertical-align: inherit;">所有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成员将从其副本集中删除，复制将被停止，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内部恢复用户帐户和群集元数据将被删除。</font><font style="vertical-align: inherit;">用户</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在所有情况下，数据都将保持不变。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您确定要解散群集吗？</font><font style="vertical-align: inherit;">[y / N]：y</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误：实例'ic-2：3306'无法删除，因为它位于'（MISSING）'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
州。</font><font style="vertical-align: inherit;">请将实例重新置于ONLINE并尝试解散群集</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再次。</font><font style="vertical-align: inherit;">如果永久无法访问实例，则可以选择</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
继续操作并仅从群集中删除实例</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元数据。</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您是否仍想继续（仅删除实例元数据）？</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[y / N]：y</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例'ic-3：3306'试图离开集群......实例'ic-1：3306'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正试图离开集群......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告：群集已成功解散，但以下实例是</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
跳过：'ic-2：3306'。</font><font style="vertical-align: inherit;">请确保此实例永久不可用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或采取任何必要的手动操作，以确保群集完全解散。</font></font><font></font>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在此示例中，群集由三个实例组成，其中一个实例在发出dissolve时处于脱机状态。</font>
							<font style="vertical-align: inherit;">捕获错误，您可以选择如何继续。</font>
							<font style="vertical-align: inherit;">在这种情况下，将</font>
						</font><code class="literal">ic-2</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">忽略</font>
							<font style="vertical-align: inherit;">缺少的</font>
							<font style="vertical-align: inherit;">实例，并且可访问的成员会更新其元数据。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当MySQL Shell以非交互模式运行时（例如，在运行批处理文件时），您可以</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								使用该</font>
						</font><code class="literal">force</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">配置</font>
							<font style="vertical-align: inherit;">操作</font>
							<font style="vertical-align: inherit;">的行为
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">要强制解析操作忽略任何无法访问的实例，请发出：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code><em class="replaceable"><code>Cluster</code></em>.dissolve({force: true})</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								可以从群集中删除任何可以访问的实例，并忽略任何无法访问的实例。</font>
							<font style="vertical-align: inherit;">本节中有关强制从群集中删除缺失实例的警告同样适用于强制解散操作的此技术。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您还可以使用该</font>
							<font style="vertical-align: inherit;">
								操作</font>
						</font><code class="literal">interactive</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">覆盖运行MySQL Shell的模式，例如，在运行批处理脚本时显示交互式提示。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code><em class="replaceable"><code>Cluster</code></em>.dissolve({interactive: true})</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在</font>
						</font><code class="literal">dba.gtidWaitTimeout</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">mysql外壳选项配置多长时间
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.dissolve()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作等待从集群中去除目标实例之前被应用集群的交易，但前提是目标实例</font>
						</font><code class="literal">ONLINE</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">如果在等待要删除的任何实例上应用集群事务时达到超时，则会发出错误，除非使用force：true，在这种情况下会跳过错误。
							</font>
						</font>
					</p>
					<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									注意
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									发出后</font>
							</font><code class="literal">cluster.dissolve()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，分配给该</font>
							</font><code class="literal"><em class="replaceable"><code>Cluster</code></em></code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">对象的</font>
								<font style="vertical-align: inherit;">任何变量
								</font>
								<font style="vertical-align: inherit;">都不再有效。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="mysql-innodb-cluster-securing"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">保护您的群集</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609043392"></a><a class="indexterm" name="idm140091609041904"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								可以将服务器实例配置为使用安全连接。</font>
							<font style="vertical-align: inherit;">有关在MySQL中使用SSL的一般信息，请参见
							</font>
						</font><a class="xref" href="security.html#encrypted-connections" title="6.3使用加密连接">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第6.3节“使用加密连接”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">本节介绍如何配置群集以使用SSL。</font>
							<font style="vertical-align: inherit;">另一种安全可能性是配置哪些服务器可以访问群集，请参阅</font>
						</font><a class="xref" href="mysql-innodb-cluster-userguide.html#create-whitelist-servers" title="创建服务器白名单">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">创建服务器白名单</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									重要
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									配置群集以使用SSL后，必须将服务器添加到</font>
							</font><code class="literal">ipWhitelist</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								使用</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">设置群集时，如果服务器实例提供SSL加密，则会在种子实例上自动启用它。</font>
							<font style="vertical-align: inherit;">将</font>
						</font><code class="literal">memberSslMode</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">传递
							</font>
							<font style="vertical-align: inherit;">给
							</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法以指定其他SSL模式。</font>
							<font style="vertical-align: inherit;">群集的SSL模式只能在创建时设置。</font>
							<font style="vertical-align: inherit;">该</font>
						</font><code class="literal">memberSslMode</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项是一个字符串，用于配置要使用的SSL模式，默认为</font>
						</font><code class="literal">AUTO</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">允许的值为
							</font>
						</font><code class="literal">DISABLED</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，</font>
						</font><code class="literal">REQUIRED</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，和
							</font>
						</font><code class="literal">AUTO</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">这些模式定义为：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											设置
										</font>
									</font><code class="literal">createCluster({memberSslMode:'DISABLED'})</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											确保为群集中的种子实例禁用SSL加密。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;"></font><code class="literal">createCluster({memberSslMode:'REQUIRED'})</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											然后为群集中的种子实例启用</font>
										<font style="vertical-align: inherit;">
											设置
										</font>
										<font style="vertical-align: inherit;">SSL加密。</font>
										<font style="vertical-align: inherit;">如果无法启用，则会引发错误。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											设置
										</font>
									</font><code class="literal">createCluster({memberSslMode:'AUTO'})</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											（默认）然后，如果服务器实例支持，则自动启用SSL加密，如果服务器不支持，则禁用SSL加密。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									注意
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									使用商业版MySQL时，默认情况下启用SSL，您可能需要为所有实例配置白名单。</font>
								<font style="vertical-align: inherit;">请参阅</font>
							</font><a class="xref" href="mysql-innodb-cluster-userguide.html#create-whitelist-servers" title="创建服务器白名单">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">创建服务器白名单</font>
								</font>
							</a>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								发出</font>
						</font><code class="literal">cluster.addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">cluster.rejoinInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令时，将根据为种子实例找到的设置启用或禁用实例上的SSL加密。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当使用</font>
						</font><code class="literal">createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">与
							</font>
						</font><code class="literal">adoptFromGR</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选择采用现有的组复制组，无SSL设置改变所采用的集群：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">memberSslMode</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">不能用
										</font>
									</font><code class="literal">adoptFromGR</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果采用的集群的SSL设置与MySQL Shell支持的SSL设置不同，换句话说，SSL用于组复制恢复和组通信，则不会修改这两个设置。</font>
										<font style="vertical-align: inherit;">这意味着您无法向群集添加新实例，除非您手动更改所采用群集的设置。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								MySQL Shell始终为群集复制和组通信启用或禁用群集的SSL，请参见
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-secure-socket-layer-support-ssl" title="18.5.2组复制安全套接字层（SSL）支持">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.5.2节“组复制安全套接字层（SSL）支持”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">被执行的验证并且如果发出错误这些设置是用于种子实例（例如作为的结果不同</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">使用
							</font>
						</font><code class="literal">adoptFromGR</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">添加一个新的实例给集群时）。</font>
							<font style="vertical-align: inherit;">必须为群集中的所有实例启用或禁用SSL加密。</font>
							<font style="vertical-align: inherit;">执行验证以确保在向集群添加新实例时保持此不变量。


							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								该</font>
						</font><code class="literal">deploySandboxInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">命令默认尝试部署具有SSL加密支持的沙箱实例。</font>
							<font style="vertical-align: inherit;">如果不可能，则在没有SSL支持的情况下部署服务器实例。</font>
							<font style="vertical-align: inherit;">使用</font>
						</font><code class="literal">ignoreSslError</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项设置为false可确保使用SSL支持部署沙箱实例，如果无法提供SSL支持，则会发出错误。</font>
							<font style="vertical-align: inherit;">如果</font>
						</font><code class="literal">ignoreSslError</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">为true（默认值），则在操作期间如果无法提供SSL支持且在没有SSL支持的情况下部署服务器实例，则不会发出错误。
							</font>
						</font>
					</p>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="create-whitelist-servers"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">创建服务器白名单</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091609007072"></a><a class="indexterm" name="idm140091609005584"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">


								当使用群集的</font>
						</font><code class="literal">createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，
							</font>
						</font><code class="literal">addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
						</font><code class="literal">rejoinInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法，您可以选择指定属于群集批准服务器，被称为白名单列表。</font>
							<font style="vertical-align: inherit;">通过以这种方式明确指定白名单，您可以提高群集的安全性，因为只有白名单中的服务器才能连接到群集。</font>
							<font style="vertical-align: inherit;">使用该</font>
						</font><code class="literal">ipWhitelist</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项可</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_ip_whitelist"><code class="literal">group_replication_ip_whitelist</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在实例上</font>
							<font style="vertical-align: inherit;">配置
							</font>
							<font style="vertical-align: inherit;">系统变量。</font>
							<font style="vertical-align: inherit;">默认情况下，如果未明确指定，白名单将自动设置为服务器具有网络接口的专用网络地址。</font>
							<font style="vertical-align: inherit;">要配置白名单，请指定要添加的服务器
							</font>
						</font><code class="literal">ipWhitelist</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">使用该方法时的选项。</font>
							<font style="vertical-align: inherit;">将服务器作为逗号分隔列表传递，并用引号括起来。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的-JS&gt; </font></font><strong class="userinput"><code>cluster.addInstance("ic@ic-3:3306", {ipWhitelist: "203.0.113.0/24, 198.51.100.110"})</code></strong>
</pre>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								这会将实例配置为仅接受来自地址</font>
						</font><code class="literal">203.0.113.0/24</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">和
							</font>
							<font style="vertical-align: inherit;">服务器的连接</font>
						</font><code class="literal">198.51.100.110</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">白名单还可以包括主机名，只有在其他服务器发出连接请求时才会解析主机名。
							</font>
						</font>
					</p>
					<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									警告
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									主机名本质上不如白名单中的IP地址安全。</font>
								<font style="vertical-align: inherit;">MySQL执行FCrDNS验证，提供良好的保护级别，但可能会受到某些类型的攻击。</font>
								<font style="vertical-align: inherit;">仅在严格必要时指定白名单中的主机名，并确保用于名称解析的所有组件（如DNS服务器）都在您的控制之下。</font>
								<font style="vertical-align: inherit;">您还可以使用hosts文件在本地实现名称解析，以避免使用外部组件。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="use-mysql-shell-execute-script"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">编写AdminAPI脚本</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091608990016"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以使用脚本自动执行集群配置，这些脚本可以使用MySQL Shell运行。</font>
							<font style="vertical-align: inherit;">例如：
							</font>
						</font>
					</p>
					<pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysqlsh -f <em class="replaceable"><code>setup-innodb-cluster.js</code></em></code></strong>
</pre>
					<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									注意
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									脚本文件名后指定的任何命令行选项都传递给脚本而</font>
							</font><span class="emphasis"><em>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">不是</font>
									</font>
								</em></span>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;"> MySQL Shell。</font>
								<font style="vertical-align: inherit;">您可以使用</font>
							</font><code class="literal">os.argv</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">JavaScript中的</font>
							</font><code class="literal">sys.argv</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">数组</font>
								<font style="vertical-align: inherit;">或</font>
								<font style="vertical-align: inherit;">Python中</font>
								<font style="vertical-align: inherit;">的</font>
								<font style="vertical-align: inherit;">数组
								</font>
								<font style="vertical-align: inherit;">来访问这些选项
								</font>
								<font style="vertical-align: inherit;">。</font>
								<font style="vertical-align: inherit;">在这两种情况下，数组中拾取的第一个选项是脚本名称。
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								示例脚本文件的内容如下所示：
							</font>
						</font>
					</p>
					<pre data-lang="js" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">print（'MySQL InnoDB集群沙箱设置\ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打印（ '================================== \ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
print（'设置带有3个MySQL服务器沙盒实例的MySQL InnoDB集群。\ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
print（'实例将安装在〜/ mysql-sandboxes。\ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
print（'它们将在端口3310,3320和3330上运行。\ n \ n'）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
var dbPass = shell.prompt（'请输入MySQL root帐户的密码：'，{type：“password”}）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尝试{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'\ nDeploying the sandbox instances。'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   dba.deploySandboxInstance（3310，{password：dbPass}）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   打印（'。'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   dba.deploySandboxInstance（3320，{password：dbPass}）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   打印（'。'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   dba.deploySandboxInstance（3330，{password：dbPass}）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'。\ nSandbox实例已成功部署。\ n \ n'）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'设置InnoDB集群...... \ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   shell.connect（'root @ localhost：3310'，dbPass）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   var cluster = dba.createCluster（“prodCluster”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'将实例添加到集群。'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   cluster.addInstance（{user：“root”，host：“localhost”，port：3320，password：dbPass}）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   打印（'。'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   cluster.addInstance（{user：“root”，host：“localhost”，port：3330，password：dbPass}）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'。\ nInstances成功添加到集群。'）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'\ nInnoDB集群已成功部署。\ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} catch（e）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   print（'\ n无法创建InnoDB集群。\ n \ n错误：'+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   + e.message +'\ n'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="configuring-election-process"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置选举过程</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091608977824"></a><a class="indexterm" name="idm140091608976336"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以选择配置单主群集如何选择新主节点，例如，将一个实例作为新主节点进行故障转移。</font>
							<font style="vertical-align: inherit;">使用该</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项并</font>
							<font style="vertical-align: inherit;">在创建群集时</font>
							<font style="vertical-align: inherit;">将其传递给</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								and </font>
						</font><code class="literal">Cluster.addInstance()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">方法。</font>
							<font style="vertical-align: inherit;">该</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								选项接受0到100之间的整数值，该值是故障转移时自动主要选举的百分比权重。</font>
							<font style="vertical-align: inherit;">当实例具有更高的设置的百分比数时
							</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，更有可能在单主群集中被选为主要。</font>
							<font style="vertical-align: inherit;">当主要选举发生时，如果多个实例具有相同的选举
							</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;"> 然后，根据字典顺序（最低）的服务器UUID并选择第一个实例来确定实例的优先级。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								设置值</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">可以</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在实例上</font>
							<font style="vertical-align: inherit;">配置
							</font>
							<font style="vertical-align: inherit;">系统变量。</font>
							<font style="vertical-align: inherit;">组复制将值范围限制为0到100，如果提供更高或更低的值，则自动调整它。</font>
							<font style="vertical-align: inherit;">如果未提供任何值，则组复制使用默认值50。</font>
							<font style="vertical-align: inherit;">更多信息</font>
						</font><a class="xref" href="group-replication.html#group-replication-single-primary-mode" title="18.4.1.1单主模式">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">，</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">请参见
							</font><a class="xref" href="group-replication.html#group-replication-single-primary-mode" title="18.4.1.1单主模式">
								<font style="vertical-align: inherit;">第18.4.1.1节“单主模式”</font>
							</a>
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								例如，要配置一个群集，其中</font>
						</font><code class="literal">ic-3</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								首选实例要故障转移到
							</font>
						</font><code class="literal">ic-1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">当前主节点，意外地离开群集</font>
						</font><code class="literal">memberWeight</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，如下所示：
							</font>
						</font>
					</p>
					<pre data-lang="mysqlsh" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dba.createCluster（'cluster1'，{memberWeight：35}）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
var mycluster = dba.getCluster（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mycluster.addInstance（'ic @ ic2'，{memberWeight：25}）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mycluster.addInstance（'ic @ ic3'，{memberWeight：50}）</font></font><font></font>
</pre>
				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="mysql-innodb-cluster-failover-consistency"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">配置故障转移一致性</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">如果主要故障转移在单主模式下发生，则</font>
							<font style="vertical-align: inherit;">
								组复制可以指定故障转移保证（最终或</font>
						</font><span class="quote">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">“ </font>
							</font><span class="quote">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">读取您的写入</font>
								</font>
							</span>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;"> ”</font>
							</font>
						</span>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">）（请参见
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-configuring-consistency-guarantees" title="18.4.3.2配置事务一致性保证">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.4.3.2节“配置事务一致性保证”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">）。</font>
							<font style="vertical-align: inherit;">您可以在创建时配置InnoDB集群的故障转移保证，方法是将该</font>
						</font><code class="literal">consistency</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项（在8.0.14版中，此选项</font>
						</font><code class="literal">failoverConsistency</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">是现已弃用</font>
							<font style="vertical-align: inherit;">的
							</font>
							<font style="vertical-align: inherit;">选项）传递给</font>
						</font><code class="literal">dba.createCluster()</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								操作，该操作将配置
							</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_consistency"><code class="literal">group_replication_consistency</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								种子实例上的系统变量。</font>
							<font style="vertical-align: inherit;">此选项定义在单主组中选择新主节点时使用的新防护机制的行为。</font>
							<font style="vertical-align: inherit;">防护限制连接从新主节点写入和读取，直到它应用来自旧主节点的任何挂起的更改积压（有时称为</font>
						</font><span class="quote">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">“ </font>
							</font><span class="quote">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">读取您的写入</font>
								</font>
							</span>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;"> ”</font>
							</font>
						</span>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">）。</font>
							<font style="vertical-align: inherit;">当防护机制到位时，应用程序实际上不会在应用任何积压的情况下在短时间内向后看时间。</font>
							<font style="vertical-align: inherit;">这可确保应用程序不会从新选择的主节点中读取过时信息。
							</font>
						</font>
					</p>
					<p>
						<font style="vertical-align: inherit;"></font><code class="literal">consistency</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">仅当目标MySQL服务器版本为8.0.14或更高版本时才支持</font>
							<font style="vertical-align: inherit;">
								该</font>
							<font style="vertical-align: inherit;">选项，并且添加到已使用该</font>
						</font><code class="literal">consistency</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项</font>
							<font style="vertical-align: inherit;">配置的群集的实例将</font>
							<font style="vertical-align: inherit;">自动配置为
							</font>
						</font><a class="link" href="group-replication.html#sysvar_group_replication_consistency"><code class="literal">group_replication_consistency</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								在支持该选项的所有集群成员上具有相同的</font>
							<font style="vertical-align: inherit;">实例
							</font>
							<font style="vertical-align: inherit;">。</font>
							<font style="vertical-align: inherit;">变量默认值由组复制控制，并且</font>
						</font><code class="literal">EVENTUAL</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">将</font>
						</font><code class="literal">consistency</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">选项
							</font>
							<font style="vertical-align: inherit;">更改
							</font>
						</font><code class="literal">BEFORE_ON_PRIMARY_FAILOVER</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">为启用防护机制。</font>
							<font style="vertical-align: inherit;">或者，使用
							</font>
						</font><code class="literal">consistency=0</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">了</font>
						</font><code class="literal">EVENTUAL</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								和</font>
						</font><code class="literal">consistency=1</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">为
							</font>
						</font><code class="literal">BEFORE_ON_PRIMARY_FAILOVER</code>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">。
							</font>
						</font>
					</p>
					<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									注意
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;"></font><code class="literal">consistency</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">在多主要InnoDB集群上</font>
								<font style="vertical-align: inherit;">
									使用该</font>
								<font style="vertical-align: inherit;">选项没有任何效果，但是允许这样做，因为稍后可以通过该</font>
							</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.switchToSinglePrimaryMode()</code>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									操作</font>
								<font style="vertical-align: inherit;">将集群更改为单主模式
								</font>
								<font style="vertical-align: inherit;">。
								</font>
							</font>
						</p>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="mysql-innodb-cluster-change-topology"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">更改群集的拓扑</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091608941504"></a><a class="indexterm" name="idm140091608940000"></a><a class="indexterm"
					 name="idm140091608938496"></a><a class="indexterm" name="idm140091608936992"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								默认情况下，InnoDB集群以单主模式运行，其中集群具有一个接受读写查询（R / W）的主服务器，并且集群中的所有其余实例仅接受读取查询（R / O） 。</font>
							<font style="vertical-align: inherit;">当您将群集配置为在多主模式下运行时，群集中的所有实例都是主要的，这意味着它们同时接受读取和写入查询（R / W）。</font>
							<font style="vertical-align: inherit;">如果群集的所有实例都运行MySQL服务器版本8.0.15或更高版本，则可以在群集联机时更改群集的拓扑。</font>
							<font style="vertical-align: inherit;">在以前的版本中，必须完全解散并重新创建群集以进行配置更改。
							</font>
						</font><a class="xref" href="group-replication.html#group-replication-configuring-online-group" title="18.4.2配置在线组">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第18.4.2节“配置在线组”</font>
							</font>
						</a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">，因此您应遵守配置在线组的规则。
							</font>
						</font>
					</p>
					<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

						<div class="admon-title">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									注意
								</font>
							</font>
						</div>
						<p>
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">
									多主模式被认为是高级模式
								</font>
							</font>
						</p>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								通常，当主节点意外离开集群时，单主节点会选择新的主节点，例如由于意外停止。</font>
							<font style="vertical-align: inherit;">选举过程通常用于选择当前的第二个成为新的主要成员。</font>
							<font style="vertical-align: inherit;">要覆盖选举过程并强制特定服务器成为新主服务器，请使用该
							</font>
							<font style="vertical-align: inherit;">
								函数，其中</font>
							<font style="vertical-align: inherit;">指定与应成为新主服务器的实例的连接。</font>
							<font style="vertical-align: inherit;">这使您可以配置基础组复制组以选择特定实例作为新主服务器，从而绕过选举过程。
							</font>
						</font><code class="literal"><em class="replaceable"><code>Cluster</code></em>.setPrimaryInstance(<em class="replaceable"><code>instance</code></em>)</code>
						<font style="vertical-align: inherit;"></font><em class="replaceable"><code>instance</code></em>
						<font style="vertical-align: inherit;"></font>
					</p>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以使用以下操作更改在单主服务器和多主服务器之间运行集群的模式（有时称为拓扑）：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.switchToMultiPrimaryMode()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">，将群集切换到多主模式。</font>
										<font style="vertical-align: inherit;">所有实例都成为初选。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.switchToSinglePrimaryMode([<em class="replaceable"><code>instance</code></em>])</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">，将群集切换到单主模式。</font>
										<font style="vertical-align: inherit;">如果
										</font>
									</font><em class="replaceable"><code>instance</code></em>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">指定，则它将成为主要实例，所有其他实例将成为辅助实例。</font>
										<font style="vertical-align: inherit;">如果</font>
									</font><em class="replaceable"><code>instance</code></em>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">未指定，则新主节点是具有最高成员权重的实例（如果成员权重相关，则为最低UUID）。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="mysql-innodb-cluster-setting-options"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">设置InnoDB集群的选项</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<a class="indexterm" name="idm140091608921888"></a><a class="indexterm" name="idm140091608920112"></a><a class="indexterm"
					 name="idm140091608918608"></a>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以在实例联机时检查和修改InnoDB群集的适当设置。</font>
							<font style="vertical-align: inherit;">要检查群集的当前设置，请使用以下操作：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.options()</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">，列出其副本服务器和实例的集群配置选项。</font>
									</font><code class="literal">all</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">还可以指定</font>
										<font style="vertical-align: inherit;">布尔选项
										</font>
										<font style="vertical-align: inherit;">以包含有关输出中所有组复制系统变量的信息。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								您可以在集群级别或实例级别配置InnoDB集群的选项，同时实例保持联机状态。</font>
							<font style="vertical-align: inherit;">这样就无需删除，重新配置，然后再添加实例来更改InnoDB集群选项。</font>
							<font style="vertical-align: inherit;">使用以下操作：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.setOption(<em class="replaceable"><code>option</code></em>,
										<em class="replaceable"><code>value</code></em>)</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">全局更改所有群集实例的设置或群集全局设置，例如</font>
									</font><code class="literal">clusterName</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal"><em class="replaceable"><code>Cluster</code></em>.setInstanceOption(instance,
										<em class="replaceable"><code>option</code></em>,
										<em class="replaceable"><code>value</code></em>)</code>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;"> 更改单个群集实例的设置
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								将InnoDB集群选项与列出的操作一起使用的方式取决于是否可以将选项更改为在所有实例上都相同。</font>
							<font style="vertical-align: inherit;">这些选项在群集（所有实例）和每个实例级别都是可更改的：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">exitStateAction</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">memberWeight</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								此选项仅在每个实例级别可更改：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">label</code>
								</p>
							</li>
						</ul>
					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								这些选项仅在群集级别可更改：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<code class="literal">consistency</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">expelTimeout</code>
								</p>
							</li>
							<li class="listitem">
								<p>
									<code class="literal">clusterName</code>
								</p>
							</li>
						</ul>
					</div>

				</div>
				<div class="simplesect">
					<div class="titlepage">
						<div>
							<div class="simple">
								<h3 class="title"><a name="mysql-innodb-cluster-auto-increment"></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">InnoDB集群和自动增量</font>
									</font>
								</h3>

							</div>

						</div>

					</div>
					<p>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								当您将实例用作InnoDB集群的一部分时，将</font>
							<font style="vertical-align: inherit;">
								配置</font>
						</font><a class="link" href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">
								和</font>
						</font><a class="link" href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">变量以避免多主集群自动增量冲突的可能性，最大为9（组复制组的最大支持大小）。</font>
							<font style="vertical-align: inherit;">用于配置这些变量的逻辑可以概括为：
							</font>
						</font>
					</p>
					<div class="itemizedlist">
						<ul class="itemizedlist" style="list-style-type: disc; ">
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果组以单主模式运行，则设置
										</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">为1和</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											2。
										</font>
									</font>
								</p>
							</li>
							<li class="listitem">
								<p>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											如果组以多主模式运行，则当群集有7个或更少实例设置
										</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">为7和</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">
											1 + </font>
									</font><a class="link" href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">％7时。如果多主群集有8个或更多实例设置
										</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">为实例数，则为
										</font>
									</font><a class="link" href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">1 + </font>
									</font><a class="link" href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a>
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">％实例数。
										</font>
									</font>
								</p>
							</li>
						</ul>
					</div>

				</div>

			</div>
			<div class="section">
				<div class="titlepage">
					<div>
						<div>
							<h2 class="title" style="clear: both"><a name="mysql-innodb-cluster-limitations"></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">21.5已知限制</font>
								</font>
							</h2>

						</div>

					</div>

				</div>
				<p>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">
							本节介绍InnoDB集群的已知限制。</font>
						<font style="vertical-align: inherit;">由于InnoDB集群使用组复制，您还应该了解其局限性，请参见
						</font>
					</font><a class="xref" href="group-replication.html#group-replication-limitations" title="18.9.2组复制限制">
						<font style="vertical-align: inherit;">
							<font style="vertical-align: inherit;">第18.9.2节“组复制限制”</font>
						</font>
					</a>
					<font style="vertical-align: inherit;">
						<font style="vertical-align: inherit;">。
						</font>
					</font>
				</p>
				<div class="itemizedlist">
					<ul class="itemizedlist" style="list-style-type: disc; ">
						<li class="listitem">
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">


										如果在创建全局会话时未指定会话类型，则MySQL Shell会提供自动协议检测，尝试首先创建NodeSession，如果失败则尝试创建ClassicSession。</font>
									<font style="vertical-align: inherit;">InnoDB集群由三个服务器实例组成，其中有一个读写端口和两个只读端口，这可能导致MySQL Shell只连接到其中一个只读实例。</font>
									<font style="vertical-align: inherit;">因此，建议在创建全局会话时始终指定会话类型。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">


										将非沙盒服务器实例（您已手动配置而非使用的实例
									</font>
								</font><code class="literal">dba.deploySandboxInstance()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">）添加到群集时，MySQL Shell无法在实例的配置文件中保留任何配置更改。</font>
									<font style="vertical-align: inherit;">这导致以下一种或两种情况：
									</font>
								</font>
							</p>
							<div class="orderedlist">
								<ol class="orderedlist" type="1">
									<li class="listitem">
										<p>
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">
													组复制配置不会保留在实例的配置文件中，并且在重新启动时，实例不会重新加入群集。
												</font>
											</font>
										</p>
									</li>
									<li class="listitem">
										<p>
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">
													该实例对群集使用无效。</font>
												<font style="vertical-align: inherit;">尽管可以使用实例验证实例
												</font>
											</font><code class="literal">dba.checkInstanceConfiguration()</code>
											<font style="vertical-align: inherit;">
												<font style="vertical-align: inherit;">，并且MySQL Shell进行必要的配置更改以使实例为群集使用做好准备，但这些更改不会在配置文件中保留，因此一旦重新启动就会丢失。
												</font>
											</font>
										</p>
									</li>
								</ol>
							</div>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果仅</font>
								</font><code class="literal">a</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">发生，则重新启动后实例不会重新加入群集。
									</font>
								</font>
							</p>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										如果</font>
								</font><code class="literal">b</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">也发生了，并且您发现重新启动后实例未重新加入群集，则无法使用</font>
								</font><code class="literal">dba.rebootClusterFromCompleteOutage()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">此情况下</font>
									<font style="vertical-align: inherit;">建议
									</font>
									<font style="vertical-align: inherit;">的群集重新联机。</font>
									<font style="vertical-align: inherit;">这是因为实例丢失了MySQL Shell所做的任何配置更改，并且由于它们没有持久化，因此在为群集配置之前，实例将恢复到先前的状态。</font>
									<font style="vertical-align: inherit;">这会导致组复制停止响应，最终命令超时。
									</font>
								</font>
							</p>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										为避免此问题，强烈建议</font>
								</font><code class="literal">dba.configureInstance()</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">在将实例添加到群集之前</font>
									<font style="vertical-align: inherit;">使用
									</font>
									<font style="vertical-align: inherit;">，以便持久保存配置更改。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#option_mysqld_defaults-extra-file"><code
									 class="option">--defaults-extra-file</code></a>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">InnoDB集群服务器实例不支持</font>
									<font style="vertical-align: inherit;">






										使用
									</font>
									<font style="vertical-align: inherit;">选项指定选项文件。</font>
									<font style="vertical-align: inherit;">InnoDB集群仅支持实例上的单个选项文件，并且不支持额外的选项文件。</font>
									<font style="vertical-align: inherit;">因此，对于使用实例的选项文件的任何操作，应指定主要操作。</font>
									<font style="vertical-align: inherit;">如果要使用多个选项文件，则必须手动配置文件，并确保它们已正确更新，并考虑使用多个选项文件的优先级规则，并确保所选设置不会被额外无法识别的选项中的选项错误地覆盖文件。
									</font>
								</font>
							</p>
						</li>
						<li class="listitem">
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">


										尝试使用具有解析为与真实网络接口不匹配的IP地址的主机名的实例失败，并显示错误：</font>
								</font><span class="errortext">
									<font style="vertical-align: inherit;">
										<font style="vertical-align: inherit;">此实例将其自己的地址报告为</font>
									</font><em class="replaceable"><code>the
											hostname</code></em>
								</span>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">。</font>
									<font style="vertical-align: inherit;">组复制通信层不支持此功能。</font>
									<font style="vertical-align: inherit;">在基于Debian的实例上，这意味着实例不能使用地址，例如
									</font>
								</font><code class="literal">user@localhost</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">因为localhost解析为不存在的IP（例如127.0.1.1）。</font>
									<font style="vertical-align: inherit;">这会影响使用沙盒部署，沙盒部署通常在单个计算机上使用本地实例。
									</font>
								</font>
							</p>
							<p>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">
										解决方法是</font>
								</font><code class="literal">report_host</code>
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">在每个实例上</font>
									<font style="vertical-align: inherit;">配置
									</font>
									<font style="vertical-align: inherit;">系统变量以使用计算机的实际IP地址。</font>
									<font style="vertical-align: inherit;">检索计算机的IP并添加
									</font>
									<font style="vertical-align: inherit;">到</font>
									<font style="vertical-align: inherit;">每个实例</font>
									<font style="vertical-align: inherit;">的
									</font>
									<font style="vertical-align: inherit;">文件中。</font>
									<font style="vertical-align: inherit;">您需要确保然后重新启动实例以进行更改。
									</font>
								</font><code class="literal">report_host=<em class="replaceable"><code>IP of your
											machine</code></em></code>
								<font style="vertical-align: inherit;"></font><code class="filename">my.cnf</code>
								<font style="vertical-align: inherit;"></font>
							</p>
						</li>
					</ul>
				</div>

			</div>

		</div>
		<div class="copyright-footer">

		</div>
		<div class="navfooter">
			<hr>
			<table width="100%" summary="Navigation footer">
				<tbody>
					<tr>
						<td width="40%" align="left"><a accesskey="p" href="document-store.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">上一页</font>
								</font>
							</a></td>
						<td width="20%" align="center"><a accesskey="u" href="">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">向上</font>
								</font>
							</a></td>
						<td width="40%" align="right">&nbsp;<a accesskey="n" href="mysql-cluster.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">下一个</font>
								</font>
							</a></td>
					</tr>
					<tr>
						<td width="40%" align="left" valign="top">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第20章将MySQL用作文档存储</font>
							</font>
						</td>
						<td width="20%" align="center"><a accesskey="h" href="index.html">
								<font style="vertical-align: inherit;">
									<font style="vertical-align: inherit;">家</font>
								</font>
							</a></td>
						<td width="40%" align="right" valign="top">
							<font style="vertical-align: inherit;">
								<font style="vertical-align: inherit;">第22章MySQL NDB Cluster 8.0</font>
							</font>
						</td>
					</tr>
				</tbody>
			</table>
		</div>


		<div id="goog-gt-tt" class="skiptranslate" dir="ltr">
			<div style="padding: 8px;">
				<div>
					<div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20"
						 height="20" alt="Google 翻译"></div>
				</div>
			</div>
			<div class="top" style="padding: 8px; float: left; width: 100%;">
				<h1 class="title gray">原文</h1>
			</div>
			<div class="middle" style="padding: 8px;">
				<div class="original-text"></div>
			</div>
			<div class="bottom" style="padding: 8px;">
				<div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div>
				<div class="started-activity-container">
					<hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;">
					<div class="activity-root"></div>
				</div>
			</div>
			<div class="status-message" style="display: none;"></div>
		</div>
		<div id="cntvlive2-is-installed"></div>
		<div class="goog-te-spinner-pos">
			<div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px"
				 height="96px" viewBox="0 0 66 66">
					<circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle>
				</svg></div>
		</div>
	</body>
</html>
